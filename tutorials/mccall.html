<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pablo Winant">

<title>McCall Model â€“ Advanced Macro: Numerical Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-944fc646c7e2aa292c8c646e2ff00dcc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/1_Julia_Basics.html">Tutorials</a></li><li class="breadcrumb-item"><a href="../tutorials/mccall.html">McCall Model</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Advanced Macro: Numerical Methods</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/session_1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/session_2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convergence of Sequences</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/session_3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Perturbation Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/session_4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/session_ddp/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete Dynamic Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/discretization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discretization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/interpolation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interpolation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/time_iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Iteration</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/1_Julia_Basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Julia Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/1_epidemiology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Epidemiology Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/2_solow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convergence of Sequences</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/3_perturbation_neoclassical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Perturbation of Neoclassical Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/4_Optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/6_discrete_dynamic_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete Dynamic Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/mccall.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">McCall Model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Pushups</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pushups/2_Optimization_pushups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization Pushups</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Exams</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exam/2023/Exam_mie37_2023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MIE 37 - Final Exam 2023</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exam/2024/Exam_mie37_2024.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MIE 37 - Final Exam 2024</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Coursework</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework/2025/coursework_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coursework 2025 - Deep Learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework/2025/coursework_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coursework 2025 - Consumption Saving</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#job-search-model" id="toc-job-search-model" class="nav-link active" data-scroll-target="#job-search-model">Job-Search Model</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="mccall.out.ipynb" download="mccall.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/1_Julia_Basics.html">Tutorials</a></li><li class="breadcrumb-item"><a href="../tutorials/mccall.html">McCall Model</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">McCall Model</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pablo Winant </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="job-search-model" class="level3">
<h3 class="anchored" data-anchor-id="job-search-model">Job-Search Model</h3>
<ul>
<li>When unemployed in date, a job-seeker
<ul>
<li>consumes unemployment benefit <span class="math inline">\(c_t = \underline{c}\)</span></li>
<li>receives in every date <span class="math inline">\(t\)</span> a job offer <span class="math inline">\(w_t\)</span>
<ul>
<li><span class="math inline">\(w_t\)</span> is i.i.d.,</li>
<li>takes values <span class="math inline">\(w_1, w_2, w_3\)</span> with probabilities <span class="math inline">\(p_1, p_2, p_3\)</span></li>
</ul></li>
<li>if job-seeker accepts, becomes employed at rate <span class="math inline">\(w_t\)</span> in the next period</li>
<li>else he stays unemployed</li>
</ul></li>
<li>When employed at rate <span class="math inline">\(w\)</span>
<ul>
<li>worker consumes salary <span class="math inline">\(c_t = w\)</span></li>
<li>with small probability <span class="math inline">\(\lambda&gt;0\)</span> looses his job:
<ul>
<li>starts next period unemployed</li>
</ul></li>
<li>otherwise stays employed at same rate</li>
</ul></li>
<li>Objective: <span class="math inline">\(\max E_0 \left\{ \sum \beta^t \log(c_t) \right\}\)</span></li>
</ul>
<p><strong>What are the states, the controls, the reward of this problem ? Write down the Bellman equation.</strong></p>
<p><strong>Define a named tuple for the model.</strong></p>
<div id="e5b96fa4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span><span class="op">/</span><span class="fl">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.3333333333333333</code></pre>
</div>
</div>
<div id="b6e30856" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> (;</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    Î²<span class="op">=</span><span class="fl">0.96</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    Î»<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    cbar<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    wvec<span class="op">=</span>[<span class="fl">0.6</span>, <span class="fl">1.0</span>, <span class="fl">1.4</span>],</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    pvec<span class="op">=</span><span class="fu">ones</span>(<span class="fl">3</span>)<span class="op">/</span><span class="fl">3</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(Î² = 0.96, Î» = 0.01, cbar = 0.8, wvec = [0.6, 1.0, 1.4], pvec = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333])</code></pre>
</div>
</div>
<p><strong>Define a function <code>value_update(V_U::Vector{Float64}, V_E::Vector{Float64}, x::Vector{Bool}, p::Parameters)::Tuple{Vector, Vector}</code>, which takes in value functions tomorrow and a policy vector and return updated values for today.</strong></p>
<div id="1698d98b" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">value_update</span>(V_U, V_E, x, p)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    (;Î²,Î»,cbar,wvec,pvec) <span class="op">=</span> p</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    n_V_U <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">3</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    n_V_E <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">3</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># enumerate all unemployed states</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># compute continuation value</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x[n] <span class="co"># if offer is accepted</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            cont <span class="op">=</span> V_E[n] </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            <span class="co"># cont = V_U' * pvec</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>            cont <span class="op">=</span> <span class="fu">sum</span>(V_U[m]<span class="op">*</span>pvec[m] <span class="cf">for</span> m<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># cont = sum(zip(V_U, pvec))</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        n_V_U[n] <span class="op">=</span> <span class="fu">log</span>(cbar) <span class="op">+</span> Î²<span class="op">*</span>cont</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># enumerate all employed states</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># receive wage</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        w <span class="op">=</span> wvec[n]</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># compute continuation value</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        cont_U <span class="op">=</span> <span class="fu">sum</span>(V_U[m]<span class="op">*</span>pvec[m] <span class="cf">for</span> m<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>) <span class="co"># as before</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>        cont_E <span class="op">=</span> V_E[n]</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        n_V_E[n] <span class="op">=</span> <span class="fu">log</span>(w) <span class="op">+</span> <span class="fu">Î²*</span>(Î»<span class="op">*</span>cont_U <span class="op">+</span> (<span class="fl">1</span><span class="op">-</span>Î»)<span class="op">*</span>cont_E)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n_V_U, n_V_E</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>value_update (generic function with 1 method)</code></pre>
</div>
</div>
<div id="70e45b20" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>V_U_0 <span class="op">=</span> [<span class="fl">0.3</span>,<span class="fl">2.4</span>, <span class="fl">2.0</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>V_E_0 <span class="op">=</span> [<span class="fl">0.3</span>, <span class="op">-</span> <span class="fl">476</span>, <span class="fl">2.0</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>x_0 <span class="op">=</span> [<span class="cn">true</span>, <span class="cn">false</span>, <span class="cn">true</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">value_update</span>(V_U_0, V_E_0, x_0, m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>([0.06485644868579027, 1.28085644868579, 1.6968564486857902], [-0.21066562376599074, -452.37536, 2.2523122366212127])</code></pre>
</div>
</div>
<p><strong>Define a function <code>policy_eval(x::Vector{Bool}, p::Parameter)::Tuple{Vector, Vector}</code> which takes in a policy vector and returns the value(s) of following this policies forever. You can add relevant arguments to the function.</strong></p>
<div id="071c3e14" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@time</span> <span class="fu">distance</span>( (V_E_0, V_U_0), (V_E_0, V_U_0) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0.000006 seconds (3 allocations: 80 bytes)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>0.0</code></pre>
</div>
</div>
<div id="9be148de" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distance</span>(a<span class="op">::</span><span class="dt">Tuple{Vector, Vector}</span>, b<span class="op">::</span><span class="dt">Tuple{Vector, Vector}</span>)  <span class="op">=</span> <span class="fu">max</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">maximum</span>(abs, ((<span class="cn">e</span><span class="op">-</span>f) <span class="cf">for</span> (<span class="cn">e</span>,f) <span class="kw">in</span>  <span class="fu">zip</span>(a[<span class="fl">1</span>],b[<span class="fl">1</span>]))  ),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">maximum</span>(abs, ((<span class="cn">e</span><span class="op">-</span>f) <span class="cf">for</span> (<span class="cn">e</span>,f) <span class="kw">in</span>  <span class="fu">zip</span>(a[<span class="fl">2</span>],b[<span class="fl">2</span>]))  ),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>distance (generic function with 1 method)</code></pre>
</div>
</div>
<div id="e88b5d5c" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distance</span>( <span class="fl">3</span>,<span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>UndefVarError: UndefVarError: `distance` not defined in `Main`
Suggestion: check for spelling errors or missing imports.
UndefVarError: `distance` not defined in `Main`

Suggestion: check for spelling errors or missing imports.



Stacktrace:

 [1] top-level scope

   @ ~/Teaching/ensae/mie37/tutorials/jl_notebook_cell_df34fa98e69747e1a8f8a730347b8e2f_X31sZmlsZQ==.jl:1</code></pre>
</div>
</div>
<div id="bc98611d" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distance</span>(a<span class="op">::</span><span class="dt">Tuple{Vector, Vector}</span>, b<span class="op">::</span><span class="dt">Tuple{Vector, Vector}</span>)  <span class="op">=</span> <span class="fu">max</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">maximum</span>(<span class="fu">abs</span>.(a[<span class="fl">1</span>]<span class="op">-</span>b[<span class="fl">1</span>])),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">maximum</span>(<span class="fu">abs</span>.(a[<span class="fl">2</span>]<span class="op">-</span>b[<span class="fl">2</span>])),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>distance (generic function with 1 method)</code></pre>
</div>
</div>
<div id="877c9649" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fun</span>(a, p<span class="op">=</span><span class="fl">.04</span>) <span class="op">=</span> a<span class="op">^</span><span class="fl">2</span><span class="op">+</span>p</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">methods</span>(fun)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
# 2 methods for generic function <b>fun</b> from [35mMain[39m:<ul><li> fun(a, p) in Main at <a href="https://github.com/albop/mie37/tree/d0d19530803af88e20ed89ba105efe13187662e1//tutorials/jl_notebook_cell_df34fa98e69747e1a8f8a730347b8e2f_X36sZmlsZQ==.jl#L1" target="_blank">/home/pablo/Teaching/ensae/mie37/tutorials/jl_notebook_cell_df34fa98e69747e1a8f8a730347b8e2f_X36sZmlsZQ==.jl:1</a></li> <li> fun(a) in Main at <a href="https://github.com/albop/mie37/tree/d0d19530803af88e20ed89ba105efe13187662e1//tutorials/jl_notebook_cell_df34fa98e69747e1a8f8a730347b8e2f_X36sZmlsZQ==.jl#L1" target="_blank">/home/pablo/Teaching/ensae/mie37/tutorials/jl_notebook_cell_df34fa98e69747e1a8f8a730347b8e2f_X36sZmlsZQ==.jl:1</a></li> </ul>
</div>
</div>
<div id="7f2898a1" class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">policy_eval</span>(x, p; T<span class="op">=</span><span class="fl">1000</span>, Ï„_Î·<span class="op">=</span><span class="fl">1e-8</span>, verbose<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    V_U_0 <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">3</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    V_E_0 <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">3</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># V_U = zeros(3)</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># V_E = zeros(3)</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> V_U, V_E</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t<span class="op">=</span><span class="fl">1</span><span class="op">:</span>T</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        V_U, V_E <span class="op">=</span> <span class="fu">value_update</span>(V_U_0, V_E_0, x, p)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        Î· <span class="op">=</span> <span class="fu">distance</span>( (V_U_0, V_E_0), (V_U, V_E))</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        V_U_0, V_E_0 <span class="op">=</span> V_U, V_E</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> Î·<span class="op">&lt;</span>Ï„_Î·</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>            <span class="pp">@show</span> (t, Î·)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># println("Iteration: $n ; Î· = $Î·")</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (; V_U, V_E)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>policy_eval (generic function with 1 method)</code></pre>
</div>
</div>
<div id="ffd113bf" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">policy_eval</span>([<span class="cn">false</span>, <span class="cn">false</span>, <span class="cn">false</span>], m; T<span class="op">=</span><span class="fl">200</span>, verbose<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(V_U = [-5.577001073670461, -5.577001073670461, -5.577001073670461], V_E = [-11.376821691845214, -1.0783107010132913, 5.705145072812092])</code></pre>
</div>
</div>
<div id="3779603a" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">policy_eval</span>([<span class="cn">true</span>, <span class="cn">true</span>, <span class="cn">true</span>], m;)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(t, Î·) = (1, 0.5108256237659907)
(t, Î·) = (2, 0.490392598815351)
(t, Î·) = (3, 0.46812561688302146)
(t, Î·) = (4, 0.4454207753467201)
(t, Î·) = (5, 0.42383554279395796)
(t, Î·) = (6, 0.4033004977021406)
(t, Î·) = (7, 0.38376450422539854)
(t, Î·) = (8, 0.36517878756433)
(t, Î·) = (9, 0.34749696233982963)
(t, Î·) = (10, 0.3306749139409164)
(t, Î·) = (11, 0.31467068710526247)
(t, Î·) = (12, 0.2994443799648252)
(t, Î·) = (13, 0.28495804330095265)
(t, Î·) = (14, 0.2711755847523154)
(t, Î·) = (15, 0.25806267773172475)
(t, Î·) = (16, 0.24558667482003127)
(t, Î·) = (17, 0.23371652541660648)
(t, Î·) = (18, 0.22242269743688414)
(t, Î·) = (19, 0.21167710285771957)
(t, Î·) = (20, 0.20145302692113276)
(t, Î·) = (21, 0.1917250608163963)
(t, Î·) = (22, 0.18246903766922973)
(t, Î·) = (23, 0.17366197167539088)
(t, Î·) = (24, 0.16528200022386397)
(t, Î·) = (25, 0.15730832886259094)
(t, Î·) = (26, 0.14972117896684178)
(t, Î·) = (27, 0.14250173797729015)
(t, Î·) = (28, 0.13563211208133197)
(t, Î·) = (29, 0.1290952812175039)
(t, Î·) = (30, 0.12287505628870754)
(t, Î·) = (31, 0.11695603847559344)
(t, Î·) = (32, 0.11132358054685731)
(t, Î·) = (33, 0.10596375006820224)
(t, Î·) = (34, 0.10086329441662656)
(t, Î·) = (35, 0.09600960751129861)
(t, Î·) = (36, 0.09139069817656775)
(t, Î·) = (37, 0.08699516005692587)
(t, Î·) = (38, 0.08281214300761874)
(t, Î·) = (39, 0.07883132588838038)
(t, Î·) = (40, 0.075042890691293)
(t, Î·) = (41, 0.07143749793730336)
(t, Î·) = (42, 0.06800626327894577)
(t, Î·) = (43, 0.06474073525006219)
(t, Î·) = (44, 0.061632874106226865)
(t, Î·) = (45, 0.0586750317021405)
(t, Î·) = (46, 0.0558599323552329)
(t, Î·) = (47, 0.053180654646908465)
(t, Î·) = (48, 0.05063061411546599)
(t, Î·) = (49, 0.04820354679681316)
(t, Î·) = (50, 0.04589349357151207)
(t, Î·) = (51, 0.04369478527834758)
(t, Î·) = (52, 0.04160202855700845)
(t, Î·) = (53, 0.03961009238390645)
(t, Î·) = (54, 0.03771409526725833)
(t, Î·) = (55, 0.03590939306897312)
(t, Î·) = (56, 0.03419156742264562)
(t, Î·) = (57, 0.032556414718378335)
(t, Î·) = (58, 0.030999935626642383)
(t, Î·) = (59, 0.02951832513473107)
(t, Î·) = (60, 0.028107963070610253)
(t, Î·) = (61, 0.0267654050903694)
(t, Î·) = (62, 0.02548737410641877)
(t, Î·) = (63, 0.02427075213493879)
(t, Î·) = (64, 0.023112572541872822)
(t, Î·) = (65, 0.022010012668108203)
(t, Î·) = (66, 0.02096038681511203)
(t, Î·) = (67, 0.019961139573410946)
(t, Î·) = (68, 0.019009839477124757)
(t, Î·) = (69, 0.01810417296855249)
(t, Î·) = (70, 0.017241938657623024)
(t, Î·) = (71, 0.01642104186178628)
(t, Î·) = (72, 0.015639489412556884)
(t, Î·) = (73, 0.01489538471572871)
(t, Î·) = (74, 0.014186923052740497)
(t, Î·) = (75, 0.013512387111479285)
(t, Î·) = (76, 0.012870142735216916)
(t, Î·) = (77, 0.012258634879042773)
(t, Î·) = (78, 0.01167638376358937)
(t, Î·) = (79, 0.011121981216486887)
(t, Î·) = (80, 0.010594087192210111)
(t, Î·) = (81, 0.010091426461784181)
(t, Î·) = (82, 0.009612785463808393)
(t, Î·) = (83, 0.009157009309152642)
(t, Î·) = (84, 0.00872299893159223)
(t, Î·) = (85, 0.008309708377396419)
(t, Î·) = (86, 0.007916142226971346)
(t, Î·) = (87, 0.007541353142205054)
(t, Î·) = (88, 0.007184439533261866)
(t, Î·) = (89, 0.0068445433390351695)
(t, Î·) = (90, 0.006520847915787442)
(t, Î·) = (91, 0.0062125760284708065)
(t, Î·) = (92, 0.005918987939995901)
(t, Î·) = (93, 0.005639379593404215)
(t, Î·) = (94, 0.005373080882598913)
(t, Î·) = (95, 0.0051194540071648476)
(t, Î·) = (96, 0.004877891907302256)
(t, Î·) = (97, 0.004647816774834723)
(t, Î·) = (98, 0.004428678636692496)
(t, Î·) = (99, 0.004219954007247395)
(t, Î·) = (100, 0.004021144606181082)
(t, Î·) = (101, 0.0038317761387069993)
(t, Î·) = (102, 0.0036513971350160546)
(t, Î·) = (103, 0.0034795778461962357)
(t, Î·) = (104, 0.0033159091937378093)
(t, Î·) = (105, 0.0031600017700981198)
(t, Î·) = (106, 0.003011484887771587)
(t, Î·) = (107, 0.002870005674587617)
(t, Î·) = (108, 0.00273522821289518)
(t, Î·) = (109, 0.0026068327205059916)
(t, Î·) = (110, 0.0024845147714600557)
(t, Î·) = (111, 0.0023679845545352407)
(t, Î·) = (112, 0.002256966167735186)
(t, Î·) = (113, 0.0021511969470395798)
(t, Î·) = (114, 0.002050426827644003)
(t, Î·) = (115, 0.0019544177361972004)
(t, Î·) = (116, 0.001862943012525875)
(t, Î·) = (117, 0.001775786859298023)
(t, Î·) = (118, 0.0016927438184666244)
(t, Î·) = (119, 0.0016136182729695747)
(t, Î·) = (120, 0.0015382239726058344)
(t, Î·) = (121, 0.0014663835829011873)
(t, Î·) = (122, 0.0013979282557592398)
(t, Î·) = (123, 0.0013326972208957955)
(t, Î·) = (124, 0.001270537397097371)
(t, Î·) = (125, 0.0012113030222238308)
(t, Î·) = (126, 0.001154855301145119)
(t, Î·) = (127, 0.0011010620706777274)
(t, Î·) = (128, 0.0010497974807428534)
(t, Î·) = (129, 0.0010009416909184665)
(t, Î·) = (130, 0.0009543805816640827)
(t, Î·) = (131, 0.0009100054794757284)
(t, Î·) = (132, 0.0008677128953742397)
(t, Î·) = (133, 0.0008274042759381928)
(t, Î·) = (134, 0.0007889857664196143)
(t, Î·) = (135, 0.0007523679852674547)
(t, Î·) = (136, 0.0007174658095472353)
(t, Î·) = (137, 0.0006841981706884326)
(t, Î·) = (138, 0.0006524878601084083)
(t, Î·) = (139, 0.0006222613441799751)
(t, Î·) = (140, 0.000593448588169565)
(t, Î·) = (141, 0.0005659828885846707)
(t, Î·) = (142, 0.000539800713688976)
(t, Î·) = (143, 0.0005148415516131877)
(t, Î·) = (144, 0.0004910477658413015)
(t, Î·) = (145, 0.00046836445763887014)
(t, Î·) = (146, 0.0004467393350786608)
(t, Î·) = (147, 0.0004261225884185649)
(t, Î·) = (148, 0.0004064667714231973)
(t, Î·) = (149, 0.0003877266884053654)
(t, Î·) = (150, 0.00036985928675647983)
(t, Î·) = (151, 0.00035282355455024117)
(t, Î·) = (152, 0.00033658042311657255)
(t, Î·) = (153, 0.00032109267433355626)
(t, Î·) = (154, 0.00030632485227855)
(t, Î·) = (155, 0.00029224317921361376)
(t, Î·) = (156, 0.0002788154755535288)
(t, Î·) = (157, 0.0002660110836671947)
(t, Î·) = (158, 0.00025380079539161216)
(t, Î·) = (159, 0.0002421567829564708)
(t, Î·) = (160, 0.00023105253325894637)
(t, Î·) = (161, 0.00022046278527554364)
(t, Î·) = (162, 0.00021036347048664084)
(t, Î·) = (163, 0.00020073165613609945)
(t, Î·) = (164, 0.00019154549122291087)
(t, Î·) = (165, 0.00018278415508632406)
(t, Î·) = (166, 0.0001744278084103712)
(t, Î·) = (167, 0.00016645754663002776)
(t, Î·) = (168, 0.00015885535553294972)
(t, Î·) = (169, 0.00015160406899283885)
(t, Î·) = (170, 0.0001446873286923278)
(t, Î·) = (171, 0.00013808954585670108)
(t, Î·) = (172, 0.0001317958647000239)
(t, Î·) = (173, 0.00012579212771868242)
(t, Î·) = (174, 0.00012006484256943395)
(t, Î·) = (175, 0.00011460115059591658)
(t, Î·) = (176, 0.00010938879676913871)
(t, Î·) = (177, 0.00010441610116274092)
(t, Î·) = (178, 9.967193171434019e-5)
(t, Î·) = (179, 9.514567830137821e-5)
(t, Î·) = (180, 9.082722808173571e-5)
(t, Î·) = (181, 8.670694197832063e-5)
(t, Î·) = (182, 8.277563228276108e-5)
(t, Î·) = (183, 7.902454137109771e-5)
(t, Î·) = (184, 7.54453213431816e-5)
(t, Î·) = (185, 7.203001474920256e-5)
(t, Î·) = (186, 6.877103609781443e-5)
(t, Î·) = (187, 6.566115439099462e-5)
(t, Î·) = (188, 6.269347634813016e-5)
(t, Î·) = (189, 5.9861430525387505e-5)
(t, Î·) = (190, 5.7158752152730585e-5)
(t, Î·) = (191, 5.457946868503427e-5)
(t, Î·) = (192, 5.2117886049529716e-5)
(t, Î·) = (193, 4.976857555405445e-5)
(t, Î·) = (194, 4.752636139571109e-5)
(t, Î·) = (195, 4.538630876993466e-5)
(t, Î·) = (196, 4.33437125550995e-5)
(t, Î·) = (197, 4.139408653003329e-5)
(t, Î·) = (198, 3.953315306759464e-5)
(t, Î·) = (199, 3.7756833375368615e-5)
(t, Î·) = (200, 3.606123815202977e-5)
(t, Î·) = (201, 3.444265870555796e-5)
(t, Î·) = (202, 3.289755848001619e-5)
(t, Î·) = (203, 3.1422564997996005e-5)
(t, Î·) = (204, 3.0014462176097823e-5)
(t, Î·) = (205, 2.8670183002788008e-5)
(t, Î·) = (206, 2.738680254310566e-5)
(t, Î·) = (207, 2.6161531334167876e-5)
(t, Î·) = (208, 2.4991709011601415e-5)
(t, Î·) = (209, 2.387479828769301e-5)
(t, Î·) = (210, 2.2808379210204066e-5)
(t, Î·) = (211, 2.179014368408616e-5)
(t, Î·) = (212, 2.081789024543923e-5)
(t, Î·) = (213, 1.9889519059290706e-5)
(t, Î·) = (214, 1.90030272406716e-5)
(t, Î·) = (215, 1.8156504285826713e-5)
(t, Î·) = (216, 1.73481277769838e-5)
(t, Î·) = (217, 1.6576159303838267e-5)
(t, Î·) = (218, 1.5838940516488265e-5)
(t, Î·) = (219, 1.5134889437717902e-5)
(t, Î·) = (220, 1.4462496871203712e-5)
(t, Î·) = (221, 1.3820323058411077e-5)
(t, Î·) = (222, 1.3206994427861218e-5)
(t, Î·) = (223, 1.2621200525586573e-5)
(t, Î·) = (224, 1.2061691073483871e-5)
(t, Î·) = (225, 1.152727320530289e-5)
(t, Î·) = (226, 1.1016808791453059e-5)
(t, Î·) = (227, 1.0529211870391464e-5)
(t, Î·) = (228, 1.006344628962097e-5)
(t, Î·) = (229, 9.618523350241048e-6)
(t, Î·) = (230, 9.193499622028867e-6)
(t, Î·) = (231, 8.787474875759926e-6)
(t, Î·) = (232, 8.399590040397698e-6)
(t, Î·) = (233, 8.029025337918938e-6)
(t, Î·) = (234, 7.674998443008008e-6)
(t, Î·) = (235, 7.336762774201588e-6)
(t, Î·) = (236, 7.013605824113256e-6)
(t, Î·) = (237, 6.704847599792174e-6)
(t, Î·) = (238, 6.4098391163724955e-6)
(t, Î·) = (239, 6.127960979540603e-6)
(t, Î·) = (240, 5.858621999976776e-6)
(t, Î·) = (241, 5.60125791793098e-6)
(t, Î·) = (242, 5.355330152667648e-6)
(t, Î·) = (243, 5.120324619412031e-6)
(t, Î·) = (244, 4.895750606692673e-6)
(t, Î·) = (245, 4.681139703421877e-6)
(t, Î·) = (246, 4.476044765056031e-6)
(t, Î·) = (247, 4.280038950810194e-6)
(t, Î·) = (248, 4.092714789294405e-6)
(t, Î·) = (249, 3.9136832725716886e-6)
(t, Î·) = (250, 3.7425730354812003e-6)
(t, Î·) = (251, 3.5790295207505096e-6)
(t, Î·) = (252, 3.422714250689296e-6)
(t, Î·) = (253, 3.2733040278287717e-6)
(t, Î·) = (254, 3.1304902954332192e-6)
(t, Î·) = (255, 2.9939784411681103e-6)
(t, Î·) = (256, 2.863487157611644e-6)
(t, Î·) = (257, 2.738747834740707e-6)
(t, Î·) = (258, 2.6195040021548266e-6)
(t, Î·) = (259, 2.5055107357729867e-6)
(t, Î·) = (260, 2.3965341746645663e-6)
(t, Î·) = (261, 2.2923509810368614e-6)
(t, Î·) = (262, 2.192747871276879e-6)
(t, Î·) = (263, 2.097521178967554e-6)
(t, Î·) = (264, 2.006476389482259e-6)
(t, Î·) = (265, 1.9194277278700156e-6)
(t, Î·) = (266, 1.8361977751624181e-6)
(t, Î·) = (267, 1.75661708823327e-6)
(t, Î·) = (268, 1.6805238125527922e-6)
(t, Î·) = (269, 1.607763362443393e-6)
(t, Î·) = (270, 1.538188090677295e-6)
(t, Î·) = (271, 1.471656961626877e-6)
(t, Î·) = (272, 1.4080352563894394e-6)
(t, Î·) = (273, 1.3471942885701083e-6)
(t, Î·) = (274, 1.2890111307228835e-6)
(t, Î·) = (275, 1.2333683478971125e-6)
(t, Î·) = (276, 1.1801537596056733e-6)
(t, Î·) = (277, 1.1292602017931586e-6)
(t, Î·) = (278, 1.0805852745932043e-6)
(t, Î·) = (279, 1.0340311717982331e-6)
(t, Î·) = (280, 9.895044357222105e-7)
(t, Î·) = (281, 9.469157760122471e-7)
(t, Î·) = (282, 9.061798849074876e-7)
(t, Î·) = (283, 8.672152453925719e-7)
(t, Î·) = (284, 8.299439819836607e-7)
(t, Î·) = (285, 7.942916688818968e-7)
(t, Î·) = (286, 7.601871878648581e-7)
(t, Î·) = (287, 7.27562596836151e-7)
(t, Î·) = (288, 6.963529557424408e-7)
(t, Î·) = (289, 6.66496219992041e-7)
(t, Î·) = (290, 6.37933077030084e-7)
(t, Î·) = (291, 6.106068681788202e-7)
(t, Î·) = (292, 5.844634252127889e-7)
(t, Î·) = (293, 5.594509921991175e-7)
(t, Î·) = (294, 5.355200975998287e-7)
(t, Î·) = (295, 5.126234619012848e-7)
(t, Î·) = (296, 4.90715891032778e-7)
(t, Î·) = (297, 4.6975419465411505e-7)
(t, Î·) = (298, 4.496970831269209e-7)
(t, Î·) = (299, 4.3050510001307885e-7)
(t, Î·) = (300, 4.1214051904603366e-7)
(t, Î·) = (301, 3.9456728018194553e-7)
(t, Î·) = (302, 3.777509185454164e-7)
(t, Î·) = (303, 3.616584791643618e-7)
(t, Î·) = (304, 3.4625846367930535e-7)
(t, Î·) = (305, 3.31520766394533e-7)
(t, Î·) = (306, 3.1741658190753697e-7)
(t, Î·) = (307, 3.0391839800358866e-7)
(t, Î·) = (308, 2.909999032851829e-7)
(t, Î·) = (309, 2.7863591967047796e-7)
(t, Î·) = (310, 2.668024166041505e-7)
(t, Î·) = (311, 2.554763689488482e-7)
(t, Î·) = (312, 2.4463581382860866e-7)
(t, Î·) = (313, 2.3425969786217138e-7)
(t, Î·) = (314, 2.2432792334825535e-7)
(t, Î·) = (315, 2.1482127010585828e-7)
(t, Î·) = (316, 2.05721345736265e-7)
(t, Î·) = (317, 1.9701056785947912e-7)
(t, Î·) = (318, 1.886721214816589e-7)
(t, Î·) = (319, 1.8068993767883512e-7)
(t, Î·) = (320, 1.730486260953512e-7)
(t, Î·) = (321, 1.6573348915471797e-7)
(t, Î·) = (322, 1.5873046166348104e-7)
(t, Î·) = (323, 1.520260859422251e-7)
(t, Î·) = (324, 1.4560750827286029e-7)
(t, Î·) = (325, 1.394624078443485e-7)
(t, Î·) = (326, 1.335790251744129e-7)
(t, Î·) = (327, 1.2794610171340537e-7)
(t, Î·) = (328, 1.225528656334518e-7)
(t, Î·) = (329, 1.1738902117031103e-7)
(t, Î·) = (330, 1.1244470954352437e-7)
(t, Î·) = (331, 1.0771051250912933e-7)
(t, Î·) = (332, 1.0317740262166808e-7)
(t, Î·) = (333, 9.88367681031832e-8)
(t, Î·) = (334, 9.468034534165781e-8)
(t, Î·) = (335, 9.070025086543865e-8)
(t, Î·) = (336, 8.688892449981722e-8)
(t, Î·) = (337, 8.323914002517085e-8)
(t, Î·) = (338, 7.974399451882164e-8)
(t, Î·) = (339, 7.639686572247228e-8)
(t, Î·) = (340, 7.319142625306085e-8)
(t, Î·) = (341, 7.012162583919235e-8)
(t, Î·) = (342, 6.718166645214296e-8)
(t, Î·) = (343, 6.436600230586009e-8)
(t, Î·) = (344, 6.166933630424865e-8)
(t, Î·) = (345, 5.9086595172175294e-8)
(t, Î·) = (346, 5.661290458647272e-8)
(t, Î·) = (347, 5.424363536121746e-8)
(t, Î·) = (348, 5.19743288407426e-8)
(t, Î·) = (349, 4.980073953220199e-8)
(t, Î·) = (350, 4.7718781814865e-8)
(t, Î·) = (351, 4.572456546725334e-8)
(t, Î·) = (352, 4.3814349481863246e-8)
(t, Î·) = (353, 4.198458114501591e-8)
(t, Î·) = (354, 4.023182853529761e-8)
(t, Î·) = (355, 3.855282315612385e-8)
(t, Î·) = (356, 3.694443861945729e-8)
(t, Î·) = (357, 3.540367998766669e-8)
(t, Î·) = (358, 3.3927669562672236e-8)
(t, Î·) = (359, 3.2513668202227564e-8)
(t, Î·) = (360, 3.115905400363772e-8)
(t, Î·) = (361, 2.986130454019076e-8)
(t, Î·) = (362, 2.861801107201245e-8)
(t, Î·) = (363, 2.7426874993352612e-8)
(t, Î·) = (364, 2.628568651630303e-8)
(t, Î·) = (365, 2.519233177622482e-8)
(t, Î·) = (366, 2.414479283174842e-8)
(t, Î·) = (367, 2.3141129901205204e-8)
(t, Î·) = (368, 2.217949202076852e-8)
(t, Î·) = (369, 2.125810283359897e-8)
(t, Î·) = (370, 2.0375271247985438e-8)
(t, Î·) = (371, 1.9529359462922002e-8)
(t, Î·) = (372, 1.8718825600672062e-8)
(t, Î·) = (373, 1.7942159757922127e-8)
(t, Î·) = (374, 1.7197955060055392e-8)
(t, Î·) = (375, 1.6484822396023446e-8)
(t, Î·) = (376, 1.5801472130760885e-8)
(t, Î·) = (377, 1.5146643050911734e-8)
(t, Î·) = (378, 1.4519137891966238e-8)
(t, Î·) = (379, 1.3917802021978787e-8)
(t, Î·) = (380, 1.3341544757849988e-8)
(t, Î·) = (381, 1.278930383818988e-8)
(t, Î·) = (382, 1.2260077397741043e-8)
(t, Î·) = (383, 1.1752895545669162e-8)
(t, Î·) = (384, 1.1266831023704071e-8)
(t, Î·) = (385, 1.080099920613975e-8)
(t, Î·) = (386, 1.0354554547120642e-8)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>(V_U = [-10.417717805631884, -0.5307702781758938, 5.9815955726093115], V_E = [-10.619348191494039, -0.320444515546618, 6.463269913351949])</code></pre>
</div>
</div>
<div id="6fa7b8d4" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">policy_eval</span>(x_0, m;)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(t, Î·) = (1, 0.5108256237659907)
(t, Î·) = (2, 0.490392598815351)
(t, Î·) = (3, 0.46812561688302146)
(t, Î·) = (4, 0.4460788524567716)
(t, Î·) = (5, 0.4248297869138624)
(t, Î·) = (6, 0.40452234933286846)
(t, Î·) = (7, 0.3851676119158367)
(t, Î·) = (8, 0.3667370420134395)
(t, Î·) = (9, 0.3491913678231824)
(t, Î·) = (10, 0.332489462473883)
(t, Î·) = (11, 0.31659102952791507)
(t, Î·) = (12, 0.30145736797222167)
(t, Î·) = (13, 0.2870515444381647)
(t, Î·) = (14, 0.27333838461626314)
(t, Î·) = (15, 0.2602844115834575)
(t, Î·) = (16, 0.24785777053778268)
(t, Î·) = (17, 0.2360281520580898)
(t, Î·) = (18, 0.22476671751561916)
(t, Î·) = (19, 0.2140460276352858)
(t, Î·) = (20, 0.20383997439472346)
(t, Î·) = (21, 0.19412371620383695)
(t, Î·) = (22, 0.18487361623708498)
(t, Î·) = (23, 0.17606718377422315)
(t, Î·) = (24, 0.16768301840536726)
(t, Î·) = (25, 0.1597007569609339)
(t, Î·) = (26, 0.152101023033401)
(t, Î·) = (27, 0.14486537896396268)
(t, Î·) = (28, 0.1379762801734481)
(t, Î·) = (29, 0.13141703172269814)
(t, Î·) = (30, 0.1251717469932716)
(t, Î·) = (31, 0.11922530838466017)
(t, Î·) = (32, 0.11356332992935236)
(t, Î·) = (33, 0.10817212173179769)
(t, Î·) = (34, 0.10303865614217145)
(t, Î·) = (35, 0.09815053557985465)
(t, Î·) = (36, 0.09349596192613419)
(t, Î·) = (37, 0.08906370740919911)
(t, Î·) = (38, 0.08484308690852416)
(t, Î·) = (39, 0.08082393160920631)
(t, Î·) = (40, 0.07699656394028054)
(t, Î·) = (41, 0.07335177373417423)
(t, Î·) = (42, 0.06988079554768589)
(t, Î·) = (43, 0.06657528708760907)
(t, Î·) = (44, 0.06342730868719926)
(t, Î·) = (45, 0.0604293037818735)
(t, Î·) = (46, 0.05757408033563394)
(t, Î·) = (47, 0.05485479317147224)
(t, Î·) = (48, 0.052264927161839836)
(t, Î·) = (49, 0.04979828123701324)
(t, Î·) = (50, 0.047448953171560504)
(t, Î·) = (51, 0.04521132511080239)
(t, Î·) = (52, 0.043080049801194065)
(t, Î·) = (53, 0.041050037490308)
(t, Î·) = (54, 0.03911644346366927)
(t, Î·) = (55, 0.037274656187435085)
(t, Î·) = (56, 0.03552028602732449)
(t, Î·) = (57, 0.033849154515682045)
(t, Î·) = (58, 0.03225728414000173)
(t, Î·) = (59, 0.03074088862742741)
(t, Î·) = (60, 0.0292963637010466)
(t, Î·) = (61, 0.027920278285026967)
(t, Î·) = (62, 0.026609366136703727)
(t, Î·) = (63, 0.02536051788475291)
(t, Î·) = (64, 0.024170773453757732)
(t, Î·) = (65, 0.02303731485630678)
(t, Î·) = (66, 0.02195745933464366)
(t, Î·) = (67, 0.020928652835053185)
(t, Î·) = (68, 0.01994846379849946)
(t, Î·) = (69, 0.019014577252406184)
(t, Î·) = (70, 0.018124789188657786)
(t, Î·) = (71, 0.01727700121415765)
(t, Î·) = (72, 0.01646921546041824)
(t, Î·) = (73, 0.015699529739805484)
(t, Î·) = (74, 0.01496613293629423)
(t, Î·) = (75, 0.014267300619362544)
(t, Î·) = (76, 0.013601390870292107)
(t, Î·) = (77, 0.01296684031030182)
(t, Î·) = (78, 0.012362160321004012)
(t, Î·) = (79, 0.011785933447569619)
(t, Î·) = (80, 0.01123680997591947)
(t, Î·) = (81, 0.010713504675369023)
(t, Î·) = (82, 0.010214793698754221)
(t, Î·) = (83, 0.009739511632368192)
(t, Î·) = (84, 0.009286548688436369)
(t, Î·) = (85, 0.008854848033198692)
(t, Î·) = (86, 0.008443403244072556)
(t, Î·) = (87, 0.008051255889554909)
(t, Î·) = (88, 0.007677493225962451)
(t, Î·) = (89, 0.007321246005346893)
(t, Î·) = (90, 0.006981686389138986)
(t, Î·) = (91, 0.006658025962469338)
(t, Î·) = (92, 0.006349513844227772)
(t, Î·) = (93, 0.006055434888274647)
(t, Î·) = (94, 0.005775107971306426)
(t, Î·) = (95, 0.005507884363286308)
(t, Î·) = (96, 0.005253146176322332)
(t, Î·) = (97, 0.00501030488833365)
(t, Î·) = (98, 0.004778799937739109)
(t, Î·) = (99, 0.004558097385817916)
(t, Î·) = (100, 0.0043476886434739015)
(t, Î·) = (101, 0.0041470892592272435)
(t, Î·) = (102, 0.003955837765538206)
(t, Î·) = (103, 0.003773494580602943)
(t, Î·) = (104, 0.003599640962899997)
(t, Î·) = (105, 0.0034338780161036198)
(t, Î·) = (106, 0.0032758257416638514)
(t, Î·) = (107, 0.0031251221370354187)
(t, Î·) = (108, 0.0029814223371040782)
(t, Î·) = (109, 0.0028443977969345724)
(t, Î·) = (110, 0.0027137355136375163)
(t, Î·) = (111, 0.0025891372857032025)
(t, Î·) = (112, 0.002470319007731092)
(t, Î·) = (113, 0.0023570099990841697)
(t, Î·) = (114, 0.0022489523647095666)
(t, Î·) = (115, 0.002145900386533839)
(t, Î·) = (116, 0.002047619944107737)
(t, Î·) = (117, 0.0019538879629585892)
(t, Î·) = (118, 0.001864491889353559)
(t, Î·) = (119, 0.0017792291902196666)
(t, Î·) = (120, 0.0016979068770268668)
(t, Î·) = (121, 0.0016203410523765172)
(t, Î·) = (122, 0.0015463564783715356)
(t, Î·) = (123, 0.0014757861655532167)
(t, Î·) = (124, 0.0014084709815058716)
(t, Î·) = (125, 0.0013442592781984786)
(t, Î·) = (126, 0.0012830065370792454)
(t, Î·) = (127, 0.0012245750311592474)
(t, Î·) = (128, 0.001168833503200517)
(t, Î·) = (129, 0.0011156568592802785)
(t, Î·) = (130, 0.0010649258769888093)
(t, Î·) = (131, 0.0010165269275006494)
(t, Î·) = (132, 0.0009703517109436177)
(t, Î·) = (133, 0.0009262970043728558)
(t, Î·) = (134, 0.0008842644217104123)
(t, Î·) = (135, 0.000844160185199172)
(t, Î·) = (136, 0.0008058949076676925)
(t, Î·) = (137, 0.0007693833851938336)
(t, Î·) = (138, 0.0007345443996413792)
(t, Î·) = (139, 0.000701300530554505)
(t, Î·) = (140, 0.0006695779760477194)
(t, Î·) = (141, 0.0006393063821761302)
(t, Î·) = (142, 0.0006104186804058997)
(t, Î·) = (143, 0.000582850932854484)
(t, Î·) = (144, 0.0005565421848245933)
(t, Î·) = (145, 0.000531434324361868)
(t, Î·) = (146, 0.0005074719485094192)
(t, Î·) = (147, 0.000484602235825804)
(t, Î·) = (148, 0.0004627748250598529)
(t, Î·) = (149, 0.0004419416994565495)
(t, Î·) = (150, 0.00042205707665843306)
(t, Î·) = (151, 0.00040307730373001505)
(t, Î·) = (152, 0.00038496075721283773)
(t, Î·) = (153, 0.00036766774789853685)
(t, Î·) = (154, 0.0003511604300747706)
(t, Î·) = (155, 0.0003354027151125649)
(t, Î·) = (156, 0.00032036018912151576)
(t, Î·) = (157, 0.00030600003447034396)
(t, Î·) = (158, 0.00029229095506622116)
(t, Î·) = (159, 0.0002792031050979915)
(t, Î·) = (160, 0.0002667080212397366)
(t, Î·) = (161, 0.00025477855793454296)
(t, Î·) = (162, 0.0002433888258259742)
(t, Î·) = (163, 0.00023251413305303004)
(t, Î·) = (164, 0.00022213092932688028)
(t, Î·) = (165, 0.0002122167526081853)
(t, Î·) = (166, 0.0002027501783672392)
(t, Î·) = (167, 0.0001937107711356134)
(t, Î·) = (168, 0.00018507903843811846)
(t, Î·) = (169, 0.00017683638682086666)
(t, Î·) = (170, 0.0001689650799825415)
(t, Î·) = (171, 0.00016144819883479045)
(t, Î·) = (172, 0.00015426960352726837)
(t, Î·) = (173, 0.00014741389713179842)
(t, Î·) = (174, 0.000140866391134864)
(t, Î·) = (175, 0.00013461307250040022)
(t, Î·) = (176, 0.00012864057229933223)
(t, Î·) = (177, 0.00012293613577796236)
(t, Î·) = (178, 0.0001174875938758646)
(t, Î·) = (179, 0.00011228333603341412)
(t, Î·) = (180, 0.00010731228431026807)
(t, Î·) = (181, 0.00010256386867624201)
(t, Î·) = (182, 9.802800351366159e-5)
(t, Î·) = (183, 9.369506515710668e-5)
(t, Î·) = (184, 8.95558705167332e-5)
(t, Î·) = (185, 8.560165670701281e-5)
(t, Î·) = (186, 8.182406160628375e-5)
(t, Î·) = (187, 7.821510534000709e-5)
(t, Î·) = (188, 7.476717262022703e-5)
(t, Î·) = (189, 7.147299589860268e-5)
(t, Î·) = (190, 6.832563934366931e-5)
(t, Î·) = (191, 6.531848351087888e-5)
(t, Î·) = (192, 6.24452107729212e-5)
(t, Î·) = (193, 5.969979140019177e-5)
(t, Î·) = (194, 5.707647030561702e-5)
(t, Î·) = (195, 5.456975439699363e-5)
(t, Î·) = (196, 5.217440051197286e-5)
(t, Î·) = (197, 4.9885403946348106e-5)
(t, Î·) = (198, 4.7697987461958746e-5)
(t, Î·) = (199, 4.560759084881738e-5)
(t, Î·) = (200, 4.360986097040609e-5)
(t, Î·) = (201, 4.170064222819292e-5)
(t, Î·) = (202, 3.9875967519975575e-5)
(t, Î·) = (203, 3.813204958902361e-5)
(t, Î·) = (204, 3.6465272788888115e-5)
(t, Î·) = (205, 3.4872185203482786e-5)
(t, Î·) = (206, 3.33494911615162e-5)
(t, Î·) = (207, 3.18940440919846e-5)
(t, Î·) = (208, 3.0502839688750782e-5)
(t, Î·) = (209, 2.9173009416183504e-5)
(t, Î·) = (210, 2.7901814306119377e-5)
(t, Î·) = (211, 2.6686639024831038e-5)
(t, Î·) = (212, 2.552498624552868e-5)
(t, Î·) = (213, 2.441447126955154e-5)
(t, Î·) = (214, 2.33528168571695e-5)
(t, Î·) = (215, 2.2337848374576197e-5)
(t, Î·) = (216, 2.136748907588526e-5)
(t, Î·) = (217, 2.0439755676449067e-5)
(t, Î·) = (218, 1.955275409670776e-5)
(t, Î·) = (219, 1.8704675380121216e-5)
(t, Î·) = (220, 1.7893791856238295e-5)
(t, Î·) = (221, 1.711845341390017e-5)
(t, Î·) = (222, 1.637708401602822e-5)
(t, Î·) = (223, 1.5668178306782465e-5)
(t, Î·) = (224, 1.4990298414119252e-5)
(t, Î·) = (225, 1.4342070890904779e-5)
(t, Î·) = (226, 1.372218380168988e-5)
(t, Î·) = (227, 1.3129383930277072e-5)
(t, Î·) = (228, 1.2562474111632582e-5)
(t, Î·) = (229, 1.2020310716565064e-5)
(t, Î·) = (230, 1.1501801211011298e-5)
(t, Î·) = (231, 1.1005901864535872e-5)
(t, Î·) = (232, 1.0531615522779703e-5)
(t, Î·) = (233, 1.0077989532675247e-5)
(t, Î·) = (234, 9.644113699636137e-6)
(t, Î·) = (235, 9.229118411724357e-6)
(t, Î·) = (236, 8.832172785133707e-6)
(t, Î·) = (237, 8.45248290914924e-6)
(t, Î·) = (238, 8.089290219004397e-6)
(t, Î·) = (239, 7.74186986873815e-6)
(t, Î·) = (240, 7.409529224844391e-6)
(t, Î·) = (241, 7.091606438081044e-6)
(t, Î·) = (242, 6.787469022384585e-6)
(t, Î·) = (243, 6.496512575893121e-6)
(t, Î·) = (244, 6.218159487758612e-6)
(t, Î·) = (245, 5.951857755093215e-6)
(t, Î·) = (246, 5.697079828337337e-6)
(t, Î·) = (247, 5.453321520576537e-6)
(t, Î·) = (248, 5.220100945280137e-6)
(t, Î·) = (249, 4.996957549963099e-6)
(t, Î·) = (250, 4.7834511214261966e-6)
(t, Î·) = (251, 4.579160901130308e-6)
(t, Î·) = (252, 4.38368471833428e-6)
(t, Î·) = (253, 4.196638151654497e-6)
(t, Î·) = (254, 4.017653719046166e-6)
(t, Î·) = (255, 3.8463801708132905e-6)
(t, Î·) = (256, 3.6824816973535235e-6)
(t, Î·) = (257, 3.5256373145386988e-6)
(t, Î·) = (258, 3.375540146066669e-6)
(t, Î·) = (259, 3.231896815947266e-6)
(t, Î·) = (260, 3.094426858751831e-6)
(t, Î·) = (261, 2.9628621263100285e-6)
(t, Î·) = (262, 2.8369462476973695e-6)
(t, Î·) = (263, 2.7164341211971532e-6)
(t, Î·) = (264, 2.6010913707352756e-6)
(t, Î·) = (265, 2.4906939302127284e-6)
(t, Î·) = (266, 2.3850275319148295e-6)
(t, Î·) = (267, 2.2838873121600045e-6)
(t, Î·) = (268, 2.187077356552436e-6)
(t, Î·) = (269, 2.094410337605268e-6)
(t, Î·) = (270, 2.0057071310475294e-6)
(t, Î·) = (271, 1.920796414367487e-6)
(t, Î·) = (272, 1.8395143790428392e-6)
(t, Î·) = (273, 1.7617043504003504e-6)
(t, Î·) = (274, 1.6872165069514722e-6)
(t, Î·) = (275, 1.6159075535426837e-6)
(t, Î·) = (276, 1.5476404442438252e-6)
(t, Î·) = (277, 1.4822841016837174e-6)
(t, Î·) = (278, 1.4197131754656311e-6)
(t, Î·) = (279, 1.3598077472920522e-6)
(t, Î·) = (280, 1.3024531426708563e-6)
(t, Î·) = (281, 1.247539643145501e-6)
(t, Î·) = (282, 1.1949623335283377e-6)
(t, Î·) = (283, 1.1446208247889444e-6)
(t, Î·) = (284, 1.0964191154982927e-6)
(t, Î·) = (285, 1.0502653502442172e-6)
(t, Î·) = (286, 1.0060716668647274e-6)
(t, Î·) = (287, 9.637540081541829e-7)
(t, Î·) = (288, 9.232319690966051e-7)
(t, Î·) = (289, 8.844286156772796e-7)
(t, Î·) = (290, 8.472703498796363e-7)
(t, Î·) = (291, 8.116867569185615e-7)
(t, Î·) = (292, 7.776104773427051e-7)
(t, Î·) = (293, 7.449770365042241e-7)
(t, Î·) = (294, 7.13724777057223e-7)
(t, Î·) = (295, 6.83794688427497e-7)
(t, Î·) = (296, 6.551302966784078e-7)
(t, Î·) = (297, 6.276775934566103e-7)
(t, Î·) = (298, 6.01384876119937e-7)
(t, Î·) = (299, 5.76202666024983e-7)
(t, Î·) = (300, 5.520836374728333e-7)
(t, Î·) = (301, 5.289824898113693e-7)
(t, Î·) = (302, 5.06855865722855e-7)
(t, Î·) = (303, 4.856622943805178e-7)
(t, Î·) = (304, 4.653620564454286e-7)
(t, Î·) = (305, 4.4591716985564744e-7)
(t, Î·) = (306, 4.272912654812444e-7)
(t, Î·) = (307, 4.0944954804444933e-7)
(t, Î·) = (308, 3.9235869664366874e-7)
(t, Î·) = (309, 3.7598683633177643e-7)
(t, Î·) = (310, 3.6030345995641255e-7)
(t, Î·) = (311, 3.4527935710571e-7)
(t, Î·) = (312, 3.3088656792301663e-7)
(t, Î·) = (313, 3.170983369216174e-7)
(t, Î·) = (314, 3.0388905614131545e-7)
(t, Î·) = (315, 2.912342011995861e-7)
(t, Î·) = (316, 2.791103099752945e-7)
(t, Î·) = (317, 2.6749490444899493e-7)
(t, Î·) = (318, 2.563664907029306e-7)
(t, Î·) = (319, 2.4570446655047817e-7)
(t, Î·) = (320, 2.3548913574700236e-7)
(t, Î·) = (321, 2.2570161206658668e-7)
(t, Î·) = (322, 2.1632385127645648e-7)
(t, Î·) = (323, 2.0733853389742762e-7)
(t, Î·) = (324, 1.987291220473253e-7)
(t, Î·) = (325, 1.9047975285957364e-7)
(t, Î·) = (326, 1.8257524558862315e-7)
(t, Î·) = (327, 1.750010731882412e-7)
(t, Î·) = (328, 1.6774331612623428e-7)
(t, Î·) = (329, 1.6078865172630685e-7)
(t, Î·) = (330, 1.5412432219363836e-7)
(t, Î·) = (331, 1.4773811685131477e-7)
(t, Î·) = (332, 1.4161832595505075e-7)
(t, Î·) = (333, 1.3575376200947176e-7)
(t, Î·) = (334, 1.3013368516112678e-7)
(t, Î·) = (335, 1.2474783517291144e-7)
(t, Î·) = (336, 1.1958637458064914e-7)
(t, Î·) = (337, 1.1463987803495002e-7)
(t, Î·) = (338, 1.0989932874849728e-7)
(t, Î·) = (339, 1.0535609007433777e-7)
(t, Î·) = (340, 1.0100188418959988e-7)
(t, Î·) = (341, 9.68287849900662e-8)
(t, Î·) = (342, 9.282921098474617e-8)
(t, Î·) = (343, 8.899588621602561e-8)
(t, Î·) = (344, 8.532186157594879e-8)
(t, Î·) = (345, 8.180045796279956e-8)
(t, Î·) = (346, 7.842529115009711e-8)
(t, Î·) = (347, 7.519025047031391e-8)
(t, Î·) = (348, 7.208947394587994e-8)
(t, Î·) = (349, 6.911734473646902e-8)
(t, Î·) = (350, 6.626850179713983e-8)
(t, Î·) = (351, 6.353777592948973e-8)
(t, Î·) = (352, 6.092025373050092e-8)
(t, Î·) = (353, 5.841119943283957e-8)
(t, Î·) = (354, 5.600609043199256e-8)
(t, Î·) = (355, 5.3700592417271764e-8)
(t, Î·) = (356, 5.149055226638666e-8)
(t, Î·) = (357, 4.9371987387303307e-8)
(t, Î·) = (358, 4.7341089270958037e-8)
(t, Î·) = (359, 4.539420572768904e-8)
(t, Î·) = (360, 4.35278373345227e-8)
(t, Î·) = (361, 4.173863743517359e-8)
(t, Î·) = (362, 4.0023387271048705e-8)
(t, Î·) = (363, 3.8379010192102214e-8)
(t, Î·) = (364, 3.6802571656835426e-8)
(t, Î·) = (365, 3.52912294943053e-8)
(t, Î·) = (366, 3.384229430025698e-8)
(t, Î·) = (367, 3.245316193556391e-8)
(t, Î·) = (368, 3.112135615879197e-8)
(t, Î·) = (369, 2.9844489546348996e-8)
(t, Î·) = (370, 2.8620284808766883e-8)
(t, Î·) = (371, 2.7446560579846846e-8)
(t, Î·) = (372, 2.6321213653091036e-8)
(t, Î·) = (373, 2.5242254508839324e-8)
(t, Î·) = (374, 2.4207739812709406e-8)
(t, Î·) = (375, 2.32158399171567e-8)
(t, Î·) = (376, 2.2264785570769163e-8)
(t, Î·) = (377, 2.1352885681835687e-8)
(t, Î·) = (378, 2.0478520212918738e-8)
(t, Î·) = (379, 1.9640129522713323e-8)
(t, Î·) = (380, 1.8836228576901703e-8)
(t, Î·) = (381, 1.8065399842726038e-8)
(t, Î·) = (382, 1.7326261314565272e-8)
(t, Î·) = (383, 1.661750559378561e-8)
(t, Î·) = (384, 1.593788212517211e-8)
(t, Î·) = (385, 1.5286182986073982e-8)
(t, Î·) = (386, 1.4661253544545616e-8)
(t, Î·) = (387, 1.4061996012060263e-8)
(t, Î·) = (388, 1.3487333916373245e-8)
(t, Î·) = (389, 1.293626894494082e-8)
(t, Î·) = (390, 1.240782054878764e-8)
(t, Î·) = (391, 1.1901057916929858e-8)
(t, Î·) = (392, 1.141507510737938e-8)
(t, Î·) = (393, 1.0949033679708009e-8)
(t, Î·) = (394, 1.0502095193487548e-8)
(t, Î·) = (395, 1.0073488709849698e-8)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>(V_U = [-10.56046812449, -2.5500924348984393, 5.838845271607704], V_E = [-10.768046440045865, -0.46914275344062545, 6.314571682478065])</code></pre>
</div>
</div>
<p><strong>Define a function <code>bellman_step(V_E::Vector, V_U::Vector, p::Parameters)::Tuple{Vector, Vector, Vector}</code> which returns updated values, together with improved policy rules.</strong></p>
<div id="c635f1e7" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">bellman_step</span>(V_U, V_E, p)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    (;Î²,Î»,cbar,wvec,pvec) <span class="op">=</span> p</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    n_x <span class="op">=</span> <span class="fu">zeros</span>(<span class="dt">Bool</span>, <span class="fl">3</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    n_V_U <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">3</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    n_V_E <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">3</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># enumerate all unemployed states</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># compute continuation value</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if accept</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        cont_accept <span class="op">=</span> V_E[n] </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if reject</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        cont_reject <span class="op">=</span> <span class="fu">sum</span>(V_U[m]<span class="op">*</span>pvec[m] <span class="cf">for</span> m<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cont_accept <span class="op">&gt;</span> cont_reject</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>            n_x[n] <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>            n_V_U[n] <span class="op">=</span> <span class="fu">log</span>(cbar) <span class="op">+</span> Î²<span class="op">*</span>cont_accept</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>            n_x[n] <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>            n_V_U[n] <span class="op">=</span> <span class="fu">log</span>(cbar) <span class="op">+</span> Î²<span class="op">*</span>cont_reject</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># enumerate all employed states</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># receive wage</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>        w <span class="op">=</span> wvec[n]</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># compute continuation value</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>        cont_U <span class="op">=</span> <span class="fu">sum</span>(V_U[m]<span class="op">*</span>pvec[m] <span class="cf">for</span> m<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>) <span class="co"># as before</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>        cont_E <span class="op">=</span> V_E[n]</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>        n_V_E[n] <span class="op">=</span> <span class="fu">log</span>(w) <span class="op">+</span> <span class="fu">Î²*</span>(Î»<span class="op">*</span>cont_U <span class="op">+</span> (<span class="fl">1</span><span class="op">-</span>Î»)<span class="op">*</span>cont_E)</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (;n_V_U, n_V_E, n_x)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>bellman_step (generic function with 1 method)</code></pre>
</div>
</div>
<div id="dc849438" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bellman_step</span>(V_U_0, V_E_0, m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(n_V_U = [0.06485644868579027, 2.08085644868579, 1.6968564486857902], n_V_E = [-1.741545623765991, 0.7651199999999997, 0.7214322366212127], n_x = Bool[1, 1, 1])</code></pre>
</div>
</div>
<p><strong>Implement Value Function Iteration</strong></p>
<div id="7e3200a8" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">value_iteration</span>(p; T<span class="op">=</span><span class="fl">1000</span>, Ï„_Î·<span class="op">=</span><span class="fl">1e-8</span>, verbose<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    V_U_0 <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">3</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    V_E_0 <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">3</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> V_U, V_E</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t<span class="op">=</span><span class="fl">1</span><span class="op">:</span>T</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>        V_U, V_E, x <span class="op">=</span> <span class="fu">bellman_step</span>(V_U_0, V_E_0, p)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        Î· <span class="op">=</span> <span class="fu">distance</span>( (V_U_0, V_E_0), (V_U, V_E))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        V_U_0, V_E_0 <span class="op">=</span> V_U, V_E</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> Î·<span class="op">&lt;</span>Ï„_Î·</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>            <span class="pp">@show</span> (t, Î·, x)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># println("Iteration: $n ; Î· = $Î·")</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (; V_U, V_E)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>value_iteration (generic function with 1 method)</code></pre>
</div>
</div>
<div id="9b98e13f" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(Î² = 0.96, Î» = 0.01, cbar = 0.8, wvec = [0.6, 1.0, 1.4], pvec = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333])</code></pre>
</div>
</div>
<div id="1c0046c4" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">value_iteration</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(t, Î·, x) = (1, 0.5108256237659907, Bool[0, 0, 0])
(t, Î·, x) = (2, 0.48763085091981395, Bool[0, 1, 1])
(t, Î·, x) = (3, 0.4630962149929281, Bool[0, 1, 1])
(t, Î·, x) = (4, 0.43904602360823586, Bool[0, 1, 1])
(t, Î·, x) = (5, 0.4160002641604996, Bool[0, 0, 1])
(t, Î·, x) = (6, 0.39388523729722946, Bool[0, 0, 1])
(t, Î·, x) = (7, 0.3725547270934362, Bool[0, 0, 1])
(t, Î·, x) = (8, 0.3521196771442874, Bool[0, 0, 1])
(t, Î·, x) = (9, 0.3326287657342153, Bool[0, 0, 1])
(t, Î·, x) = (10, 0.31409252865426396, Bool[0, 0, 1])
(t, Î·, x) = (11, 0.2964985089906609, Bool[0, 0, 1])
(t, Î·, x) = (12, 0.2798207532429604, Bool[0, 0, 1])
(t, Î·, x) = (13, 0.26402574614661223, Bool[0, 0, 1])
(t, Î·, x) = (14, 0.24907610309183692, Bool[0, 0, 1])
(t, Î·, x) = (15, 0.2349328514342366, Bool[0, 0, 1])
(t, Î·, x) = (16, 0.2215568246184949, Bool[0, 0, 1])
(t, Î·, x) = (17, 0.20890949927437052, Bool[0, 0, 1])
(t, Î·, x) = (18, 0.1969534833026243, Bool[0, 0, 1])
(t, Î·, x) = (19, 0.18565278597628865, Bool[0, 0, 1])
(t, Î·, x) = (20, 0.17497295255231649, Bool[0, 0, 1])
(t, Î·, x) = (21, 0.1648811153002665, Bool[0, 0, 1])
(t, Î·, x) = (22, 0.15534599357687018, Bool[0, 0, 1])
(t, Î·, x) = (23, 0.14633786342713684, Bool[0, 0, 1])
(t, Î·, x) = (24, 0.13782850953908365, Bool[0, 0, 1])
(t, Î·, x) = (25, 0.12979116755851905, Bool[0, 0, 1])
(t, Î·, x) = (26, 0.12220046173543686, Bool[0, 0, 1])
(t, Î·, x) = (27, 0.11503234096423398, Bool[0, 0, 1])
(t, Î·, x) = (28, 0.10826401507998096, Bool[0, 0, 1])
(t, Î·, x) = (29, 0.10202559979801862, Bool[0, 0, 1])
(t, Î·, x) = (30, 0.09794454836367006, Bool[0, 0, 1])
(t, Î·, x) = (31, 0.09402674912941844, Bool[0, 0, 1])
(t, Î·, x) = (32, 0.09026566825850679, Bool[0, 0, 1])
(t, Î·, x) = (33, 0.08665503465319091, Bool[0, 0, 1])
(t, Î·, x) = (34, 0.08318882893307933, Bool[0, 0, 1])
(t, Î·, x) = (35, 0.07986127304361101, Bool[0, 0, 1])
(t, Î·, x) = (36, 0.07666682039952377, Bool[0, 0, 1])
(t, Î·, x) = (37, 0.07360014649777913, Bool[0, 0, 1])
(t, Î·, x) = (38, 0.07065613995340048, Bool[0, 0, 1])
(t, Î·, x) = (39, 0.06782989392377736, Bool[0, 0, 1])
(t, Î·, x) = (40, 0.06511669789481633, Bool[0, 0, 1])
(t, Î·, x) = (41, 0.06251202980754833, Bool[0, 0, 1])
(t, Î·, x) = (42, 0.06001154850714929, Bool[0, 0, 1])
(t, Î·, x) = (43, 0.05761108649871716, Bool[0, 0, 1])
(t, Î·, x) = (44, 0.05530664299581112, Bool[0, 0, 1])
(t, Î·, x) = (45, 0.05309437724889765, Bool[0, 0, 1])
(t, Î·, x) = (46, 0.0509706021418701, Bool[0, 0, 1])
(t, Î·, x) = (47, 0.04893177804543303, Bool[0, 0, 1])
(t, Î·, x) = (48, 0.046974506916830805, Bool[0, 0, 1])
(t, Î·, x) = (49, 0.045095526635881455, Bool[0, 0, 1])
(t, Î·, x) = (50, 0.043291705567749084, Bool[0, 0, 1])
(t, Î·, x) = (51, 0.04156003734333957, Bool[0, 0, 1])
(t, Î·, x) = (52, 0.03989763584853456, Bool[0, 0, 1])
(t, Î·, x) = (53, 0.03830173041391749, Bool[0, 0, 1])
(t, Î·, x) = (54, 0.03676966119693503, Bool[0, 0, 1])
(t, Î·, x) = (55, 0.0352988747487899, Bool[0, 0, 1])
(t, Î·, x) = (56, 0.03388691975866909, Bool[0, 0, 1])
(t, Î·, x) = (57, 0.03253144296821553, Bool[0, 0, 1])
(t, Î·, x) = (58, 0.03123018524941923, Bool[0, 0, 1])
(t, Î·, x) = (59, 0.02998097783940068, Bool[0, 0, 1])
(t, Î·, x) = (60, 0.028781738725797368, Bool[0, 0, 1])
(t, Î·, x) = (61, 0.027630469176748385, Bool[0, 0, 1])
(t, Î·, x) = (62, 0.026525250409668466, Bool[0, 0, 1])
(t, Î·, x) = (63, 0.02546424039327455, Bool[0, 0, 1])
(t, Î·, x) = (64, 0.02444567077753934, Bool[0, 0, 1])
(t, Î·, x) = (65, 0.02346784394643464, Bool[0, 0, 1])
(t, Î·, x) = (66, 0.02252913018857594, Bool[0, 0, 1])
(t, Î·, x) = (67, 0.02162796498103159, Bool[0, 0, 1])
(t, Î·, x) = (68, 0.020762846381790823, Bool[0, 0, 1])
(t, Î·, x) = (69, 0.01993233252651816, Bool[0, 0, 1])
(t, Î·, x) = (70, 0.019135039225457007, Bool[0, 0, 1])
(t, Î·, x) = (71, 0.01836963765643862, Bool[0, 0, 1])
(t, Î·, x) = (72, 0.01763485215018079, Bool[0, 0, 1])
(t, Î·, x) = (73, 0.01692945806417434, Bool[0, 0, 1])
(t, Î·, x) = (74, 0.016252279741607367, Bool[0, 0, 1])
(t, Î·, x) = (75, 0.015602188551943286, Bool[0, 0, 1])
(t, Î·, x) = (76, 0.014978101009865519, Bool[0, 0, 1])
(t, Î·, x) = (77, 0.014378976969469548, Bool[0, 0, 1])
(t, Î·, x) = (78, 0.013803817890691406, Bool[0, 0, 1])
(t, Î·, x) = (79, 0.01325166517506382, Bool[0, 0, 1])
(t, Î·, x) = (80, 0.012721598568061765, Bool[0, 0, 1])
(t, Î·, x) = (81, 0.012212734625339117, Bool[0, 0, 1])
(t, Î·, x) = (82, 0.011724225240325126, Bool[0, 0, 1])
(t, Î·, x) = (83, 0.01125525623071244, Bool[0, 0, 1])
(t, Î·, x) = (84, 0.010805045981484795, Bool[0, 0, 1])
(t, Î·, x) = (85, 0.010372844142223947, Bool[0, 0, 1])
(t, Î·, x) = (86, 0.009957930376534918, Bool[0, 0, 1])
(t, Î·, x) = (87, 0.0095596131614748, Bool[0, 0, 1])
(t, Î·, x) = (88, 0.009177228635015133, Bool[0, 0, 1])
(t, Î·, x) = (89, 0.008810139489614954, Bool[0, 0, 1])
(t, Î·, x) = (90, 0.008457733910029575, Bool[0, 0, 1])
(t, Î·, x) = (91, 0.008119424553628463, Bool[0, 0, 1])
(t, Î·, x) = (92, 0.00779464757148407, Bool[0, 0, 1])
(t, Î·, x) = (93, 0.007482861668624885, Bool[0, 0, 1])
(t, Î·, x) = (94, 0.0071835472018797475, Bool[0, 0, 1])
(t, Î·, x) = (95, 0.0068962053138044155, Bool[0, 0, 1])
(t, Î·, x) = (96, 0.0066203571012524165, Bool[0, 0, 1])
(t, Î·, x) = (97, 0.006355542817202853, Bool[0, 0, 1])
(t, Î·, x) = (98, 0.006101321104514668, Bool[0, 0, 1])
(t, Î·, x) = (99, 0.005857268260333726, Bool[0, 0, 1])
(t, Î·, x) = (100, 0.005622977529919915, Bool[0, 0, 1])
(t, Î·, x) = (101, 0.005398058428723651, Bool[0, 0, 1])
(t, Î·, x) = (102, 0.005182136091574918, Bool[0, 0, 1])
(t, Î·, x) = (103, 0.0049748506479119214, Bool[0, 0, 1])
(t, Î·, x) = (104, 0.004775856621995089, Bool[0, 0, 1])
(t, Î·, x) = (105, 0.0045848223571143265, Bool[0, 0, 1])
(t, Î·, x) = (106, 0.004401429462830286, Bool[0, 0, 1])
(t, Î·, x) = (107, 0.004225372284317075, Bool[0, 0, 1])
(t, Î·, x) = (108, 0.004056357392944854, Bool[0, 0, 1])
(t, Î·, x) = (109, 0.003894103097227486, Bool[0, 0, 1])
(t, Î·, x) = (110, 0.0037383389733376404, Bool[0, 0, 1])
(t, Î·, x) = (111, 0.003588805414404206, Bool[0, 0, 1])
(t, Î·, x) = (112, 0.0034452531978281797, Bool[0, 0, 1])
(t, Î·, x) = (113, 0.0033074430699153723, Bool[0, 0, 1])
(t, Î·, x) = (114, 0.003175145347118935, Bool[0, 0, 1])
(t, Î·, x) = (115, 0.003048139533234462, Bool[0, 0, 1])
(t, Î·, x) = (116, 0.0029262139519046215, Bool[0, 0, 1])
(t, Î·, x) = (117, 0.002809165393828472, Bool[0, 0, 1])
(t, Î·, x) = (118, 0.0026967987780759373, Bool[0, 0, 1])
(t, Î·, x) = (119, 0.0025889268269523313, Bool[0, 0, 1])
(t, Î·, x) = (120, 0.0024853697538738118, Bool[0, 0, 1])
(t, Î·, x) = (121, 0.0023859549637190725, Bool[0, 0, 1])
(t, Î·, x) = (122, 0.0022905167651705582, Bool[0, 0, 1])
(t, Î·, x) = (123, 0.002198896094562919, Bool[0, 0, 1])
(t, Î·, x) = (124, 0.0021109402507812902, Bool[0, 0, 1])
(t, Î·, x) = (125, 0.0020265026407502162, Bool[0, 0, 1])
(t, Î·, x) = (126, 0.001945442535120634, Bool[0, 0, 1])
(t, Î·, x) = (127, 0.0018676248337152757, Bool[0, 0, 1])
(t, Î·, x) = (128, 0.001792919840366558, Bool[0, 0, 1])
(t, Î·, x) = (129, 0.001721203046751718, Bool[0, 0, 1])
(t, Î·, x) = (130, 0.0016523549248814717, Bool[0, 0, 1])
(t, Î·, x) = (131, 0.001586260727885147, Bool[0, 0, 1])
(t, Î·, x) = (132, 0.0015228102987716596, Bool[0, 0, 1])
(t, Î·, x) = (133, 0.0014618978868208288, Bool[0, 0, 1])
(t, Î·, x) = (134, 0.0014034219713474627, Bool[0, 0, 1])
(t, Î·, x) = (135, 0.0013472850924927116, Bool[0, 0, 1])
(t, Î·, x) = (136, 0.0012933936887931097, Bool[0, 0, 1])
(t, Î·, x) = (137, 0.0012416579412413142, Bool[0, 0, 1])
(t, Î·, x) = (138, 0.0011919916235916261, Bool[0, 0, 1])
(t, Î·, x) = (139, 0.001144311958649169, Bool[0, 0, 1])
(t, Î·, x) = (140, 0.0010985394803038062, Bool[0, 0, 1])
(t, Î·, x) = (141, 0.0010545979010911921, Bool[0, 0, 1])
(t, Î·, x) = (142, 0.0010124139850473668, Bool[0, 0, 1])
(t, Î·, x) = (143, 0.0009719174256446195, Bool[0, 0, 1])
(t, Î·, x) = (144, 0.0009330407286203268, Bool[0, 0, 1])
(t, Î·, x) = (145, 0.0008957190994758335, Bool[0, 0, 1])
(t, Î·, x) = (146, 0.0008598903354961607, Bool[0, 0, 1])
(t, Î·, x) = (147, 0.0008254947220764919, Bool[0, 0, 1])
(t, Î·, x) = (148, 0.0007924749331937875, Bool[0, 0, 1])
(t, Î·, x) = (149, 0.000760775935865432, Bool[0, 0, 1])
(t, Î·, x) = (150, 0.0007303448984306016, Bool[0, 0, 1])
(t, Î·, x) = (151, 0.0007011311024935907, Bool[0, 0, 1])
(t, Î·, x) = (152, 0.0006730858583940957, Bool[0, 0, 1])
(t, Î·, x) = (153, 0.0006461624240579056, Bool[0, 0, 1])
(t, Î·, x) = (154, 0.0006203159270956604, Bool[0, 0, 1])
(t, Î·, x) = (155, 0.0005955032900120116, Bool[0, 0, 1])
(t, Î·, x) = (156, 0.0005716831584114956, Bool[0, 0, 1])
(t, Î·, x) = (157, 0.0005488158320741121, Bool[0, 0, 1])
(t, Î·, x) = (158, 0.0005268631987913608, Bool[0, 0, 1])
(t, Î·, x) = (159, 0.0005057886708410564, Bool[0, 0, 1])
(t, Î·, x) = (160, 0.0004855571240076628, Bool[0, 0, 1])
(t, Î·, x) = (161, 0.00046613483904689446, Bool[0, 0, 1])
(t, Î·, x) = (162, 0.00044748944548445024, Bool[0, 0, 1])
(t, Î·, x) = (163, 0.000429589867665392, Bool[0, 0, 1])
(t, Î·, x) = (164, 0.00041240627295913157, Bool[0, 0, 1])
(t, Î·, x) = (165, 0.00039591002204097947, Bool[0, 0, 1])
(t, Î·, x) = (166, 0.00038007362115966004, Bool[0, 0, 1])
(t, Î·, x) = (167, 0.00036487067631263415, Bool[0, 0, 1])
(t, Î·, x) = (168, 0.00035027584925995114, Bool[0, 0, 1])
(t, Î·, x) = (169, 0.00033626481528870045, Bool[0, 0, 1])
(t, Î·, x) = (170, 0.00032281422267743665, Bool[0, 0, 1])
(t, Î·, x) = (171, 0.00030990165377176027, Bool[0, 0, 1])
(t, Î·, x) = (172, 0.000297505587620428, Bool[0, 0, 1])
(t, Î·, x) = (173, 0.0002856053641160372, Bool[0, 0, 1])
(t, Î·, x) = (174, 0.0002741811495514668, Bool[0, 0, 1])
(t, Î·, x) = (175, 0.0002632139035689818, Bool[0, 0, 1])
(t, Î·, x) = (176, 0.0002526853474265067, Bool[0, 0, 1])
(t, Î·, x) = (177, 0.00024257793352955304, Bool[0, 0, 1])
(t, Î·, x) = (178, 0.0002328748161879446, Bool[0, 0, 1])
(t, Î·, x) = (179, 0.00022355982354049786, Bool[0, 0, 1])
(t, Î·, x) = (180, 0.00021461743059969507, Bool[0, 0, 1])
(t, Î·, x) = (181, 0.0002060327333754941, Bool[0, 0, 1])
(t, Î·, x) = (182, 0.00019779142404008354, Bool[0, 0, 1])
(t, Î·, x) = (183, 0.00018987976707851573, Bool[0, 0, 1])
(t, Î·, x) = (184, 0.00018228457639501983, Bool[0, 0, 1])
(t, Î·, x) = (185, 0.00017499319333946772, Bool[0, 0, 1])
(t, Î·, x) = (186, 0.00016799346560603112, Bool[0, 0, 1])
(t, Î·, x) = (187, 0.00016127372698093723, Bool[0, 0, 1])
(t, Î·, x) = (188, 0.00015482277790290766, Bool[0, 0, 1])
(t, Î·, x) = (189, 0.00014862986678654266, Bool[0, 0, 1])
(t, Î·, x) = (190, 0.0001426846721148678, Bool[0, 0, 1])
(t, Î·, x) = (191, 0.00013697728523087704, Bool[0, 0, 1])
(t, Î·, x) = (192, 0.00013149819382007877, Bool[0, 0, 1])
(t, Î·, x) = (193, 0.00012623826606805721, Bool[0, 0, 1])
(t, Î·, x) = (194, 0.00012118873542554809, Bool[0, 0, 1])
(t, Î·, x) = (195, 0.00011634118600856169, Bool[0, 0, 1])
(t, Î·, x) = (196, 0.0001116875385687166, Bool[0, 0, 1])
(t, Î·, x) = (197, 0.0001072200370257903, Bool[0, 0, 1])
(t, Î·, x) = (198, 0.00010293123554383499, Bool[0, 0, 1])
(t, Î·, x) = (199, 9.881398612332504e-5, Bool[0, 0, 1])
(t, Î·, x) = (200, 9.486142667736175e-5, Bool[0, 0, 1])
(t, Î·, x) = (201, 9.10669696114752e-5, Bool[0, 0, 1])
(t, Î·, x) = (202, 8.742429082708725e-5, Bool[0, 0, 1])
(t, Î·, x) = (203, 8.39273191939327e-5, Bool[0, 0, 1])
(t, Î·, x) = (204, 8.057022642571354e-5, Bool[0, 0, 1])
(t, Î·, x) = (205, 7.734741736875606e-5, Bool[0, 0, 1])
(t, Î·, x) = (206, 7.425352067436108e-5, Bool[0, 0, 1])
(t, Î·, x) = (207, 7.128337984774191e-5, Bool[0, 0, 1])
(t, Î·, x) = (208, 6.843204465312169e-5, Bool[0, 0, 1])
(t, Î·, x) = (209, 6.569476286610865e-5, Bool[0, 0, 1])
(t, Î·, x) = (210, 6.306697235114456e-5, Bool[0, 0, 1])
(t, Î·, x) = (211, 6.054429345780932e-5, Bool[0, 0, 1])
(t, Î·, x) = (212, 5.8122521719994324e-5, Bool[0, 0, 1])
(t, Î·, x) = (213, 5.579762085083928e-5, Bool[0, 0, 1])
(t, Î·, x) = (214, 5.35657160174452e-5, Bool[0, 0, 1])
(t, Î·, x) = (215, 5.142308737671186e-5, Bool[0, 0, 1])
(t, Î·, x) = (216, 4.9366163882069714e-5, Bool[0, 0, 1])
(t, Î·, x) = (217, 4.739151732646718e-5, Bool[0, 0, 1])
(t, Î·, x) = (218, 4.5495856633159804e-5, Bool[0, 0, 1])
(t, Î·, x) = (219, 4.3676022368543954e-5, Bool[0, 0, 1])
(t, Î·, x) = (220, 4.192898147348245e-5, Bool[0, 0, 1])
(t, Î·, x) = (221, 4.0251822214898425e-5, Bool[0, 0, 1])
(t, Î·, x) = (222, 3.864174932655118e-5, Bool[0, 0, 1])
(t, Î·, x) = (223, 3.7096079353204914e-5, Bool[0, 0, 1])
(t, Î·, x) = (224, 3.561223617865039e-5, Bool[0, 0, 1])
(t, Î·, x) = (225, 3.418774673136227e-5, Bool[0, 0, 1])
(t, Î·, x) = (226, 3.282023686246305e-5, Bool[0, 0, 1])
(t, Î·, x) = (227, 3.150742738800005e-5, Bool[0, 0, 1])
(t, Î·, x) = (228, 3.024713029198267e-5, Bool[0, 0, 1])
(t, Î·, x) = (229, 2.9037245080409946e-5, Bool[0, 0, 1])
(t, Î·, x) = (230, 2.787575527740671e-5, Bool[0, 0, 1])
(t, Î·, x) = (231, 2.6760725066132807e-5, Bool[0, 0, 1])
(t, Î·, x) = (232, 2.569029606291906e-5, Bool[0, 0, 1])
(t, Î·, x) = (233, 2.4662684221077313e-5, Bool[0, 0, 1])
(t, Î·, x) = (234, 2.3676176851950004e-5, Bool[0, 0, 1])
(t, Î·, x) = (235, 2.272912977741015e-5, Bool[0, 0, 1])
(t, Î·, x) = (236, 2.1819964586278218e-5, Bool[0, 0, 1])
(t, Î·, x) = (237, 2.0947166002649453e-5, Bool[0, 0, 1])
(t, Î·, x) = (238, 2.010927936346718e-5, Bool[0, 0, 1])
(t, Î·, x) = (239, 1.930490818846664e-5, Bool[0, 0, 1])
(t, Î·, x) = (240, 1.8532711861141138e-5, Bool[0, 0, 1])
(t, Î·, x) = (241, 1.779140338697971e-5, Bool[0, 0, 1])
(t, Î·, x) = (242, 1.7079747251180777e-5, Bool[0, 0, 1])
(t, Î·, x) = (243, 1.6396557361630926e-5, Bool[0, 0, 1])
(t, Î·, x) = (244, 1.574069506737885e-5, Bool[0, 0, 1])
(t, Î·, x) = (245, 1.5111067265038969e-5, Bool[0, 0, 1])
(t, Î·, x) = (246, 1.4506624574472937e-5, Bool[0, 0, 1])
(t, Î·, x) = (247, 1.392635959174271e-5, Bool[0, 0, 1])
(t, Î·, x) = (248, 1.3369305206900606e-5, Bool[0, 0, 1])
(t, Î·, x) = (249, 1.2834532998162729e-5, Bool[0, 0, 1])
(t, Î·, x) = (250, 1.2321151679373088e-5, Bool[0, 0, 1])
(t, Î·, x) = (251, 1.1828305611416567e-5, Bool[0, 0, 1])
(t, Î·, x) = (252, 1.1355173388238882e-5, Bool[0, 0, 1])
(t, Î·, x) = (253, 1.0900966453064598e-5, Bool[0, 0, 1])
(t, Î·, x) = (254, 1.0464927793663037e-5, Bool[0, 0, 1])
(t, Î·, x) = (255, 1.0046330682023097e-5, Bool[0, 0, 1])
(t, Î·, x) = (256, 9.644477454884282e-6, Bool[0, 0, 1])
(t, Î·, x) = (257, 9.258698357328399e-6, Bool[0, 0, 1])
(t, Î·, x) = (258, 8.888350423674751e-6, Bool[0, 0, 1])
(t, Î·, x) = (259, 8.532816405448784e-6, Bool[0, 0, 1])
(t, Î·, x) = (260, 8.191503749088724e-6, Bool[0, 0, 1])
(t, Î·, x) = (261, 7.863843599409392e-6, Bool[0, 0, 1])
(t, Î·, x) = (262, 7.549289856356722e-6, Bool[0, 0, 1])
(t, Î·, x) = (263, 7.247318261960345e-6, Bool[0, 0, 1])
(t, Î·, x) = (264, 6.957425531695094e-6, Bool[0, 0, 1])
(t, Î·, x) = (265, 6.679128510711507e-6, Bool[0, 0, 1])
(t, Î·, x) = (266, 6.411963370034357e-6, Bool[0, 0, 1])
(t, Î·, x) = (267, 6.155484834735603e-6, Bool[0, 0, 1])
(t, Î·, x) = (268, 5.909265441417233e-6, Bool[0, 0, 1])
(t, Î·, x) = (269, 5.672894824115815e-6, Bool[0, 0, 1])
(t, Î·, x) = (270, 5.445979031293291e-6, Bool[0, 0, 1])
(t, Î·, x) = (271, 5.2281398703613036e-6, Bool[0, 0, 1])
(t, Î·, x) = (272, 5.0190142752981615e-6, Bool[0, 0, 1])
(t, Î·, x) = (273, 4.818253703575692e-6, Bool[0, 0, 1])
(t, Î·, x) = (274, 4.625523555290556e-6, Bool[0, 0, 1])
(t, Î·, x) = (275, 4.440502613611841e-6, Bool[0, 0, 1])
(t, Î·, x) = (276, 4.262882508321297e-6, Bool[0, 0, 1])
(t, Î·, x) = (277, 4.092367207775283e-6, Bool[0, 0, 1])
(t, Î·, x) = (278, 3.928672519748488e-6, Bool[0, 0, 1])
(t, Î·, x) = (279, 3.7715256189230217e-6, Bool[0, 0, 1])
(t, Î·, x) = (280, 3.6206645948055893e-6, Bool[0, 0, 1])
(t, Î·, x) = (281, 3.4758380111910014e-6, Bool[0, 0, 1])
(t, Î·, x) = (282, 3.33680449138285e-6, Bool[0, 0, 1])
(t, Î·, x) = (283, 3.2033323114077916e-6, Bool[0, 0, 1])
(t, Î·, x) = (284, 3.0751990180988287e-6, Bool[0, 0, 1])
(t, Î·, x) = (285, 2.9521910578367283e-6, Bool[0, 0, 1])
(t, Î·, x) = (286, 2.8341034150614064e-6, Bool[0, 0, 1])
(t, Î·, x) = (287, 2.72073927920502e-6, Bool[0, 0, 1])
(t, Î·, x) = (288, 2.611909707184168e-6, Bool[0, 0, 1])
(t, Î·, x) = (289, 2.507433319642871e-6, Bool[0, 0, 1])
(t, Î·, x) = (290, 2.4071359874255904e-6, Bool[0, 0, 1])
(t, Î·, x) = (291, 2.310850548248311e-6, Bool[0, 0, 1])
(t, Î·, x) = (292, 2.2184165260341615e-6, Bool[0, 0, 1])
(t, Î·, x) = (293, 2.1296798653480664e-6, Bool[0, 0, 1])
(t, Î·, x) = (294, 2.044492670272291e-6, Bool[0, 0, 1])
(t, Î·, x) = (295, 1.962712962821911e-6, Bool[0, 0, 1])
(t, Î·, x) = (296, 1.8842044440248173e-6, Bool[0, 0, 1])
(t, Î·, x) = (297, 1.8088362665480417e-6, Bool[0, 0, 1])
(t, Î·, x) = (298, 1.7364828162058643e-6, Bool[0, 0, 1])
(t, Î·, x) = (299, 1.6670235032378855e-6, Bool[0, 0, 1])
(t, Î·, x) = (300, 1.6003425642452385e-6, Bool[0, 0, 1])
(t, Î·, x) = (301, 1.536328861462266e-6, Bool[0, 0, 1])
(t, Î·, x) = (302, 1.474875706897194e-6, Bool[0, 0, 1])
(t, Î·, x) = (303, 1.4158806775910193e-6, Bool[0, 0, 1])
(t, Î·, x) = (304, 1.3592454513045027e-6, Bool[0, 0, 1])
(t, Î·, x) = (305, 1.3048756333233769e-6, Bool[0, 0, 1])
(t, Î·, x) = (306, 1.252680607244372e-6, Bool[0, 0, 1])
(t, Î·, x) = (307, 1.2025733830967056e-6, Bool[0, 0, 1])
(t, Î·, x) = (308, 1.1544704481281087e-6, Bool[0, 0, 1])
(t, Î·, x) = (309, 1.1082916309135271e-6, Bool[0, 0, 1])
(t, Î·, x) = (310, 1.0639599654638232e-6, Bool[0, 0, 1])
(t, Î·, x) = (311, 1.0214015668807974e-6, Bool[0, 0, 1])
(t, Î·, x) = (312, 9.805455034594956e-7, Bool[0, 0, 1])
(t, Î·, x) = (313, 9.413236830013716e-7, Bool[0, 0, 1])
(t, Î·, x) = (314, 9.036707364629137e-7, Bool[0, 0, 1])
(t, Î·, x) = (315, 8.675239069333429e-7, Bool[0, 0, 1])
(t, Î·, x) = (316, 8.328229501586293e-7, Bool[0, 0, 1])
(t, Î·, x) = (317, 7.995100332891525e-7, Bool[0, 0, 1])
(t, Î·, x) = (318, 7.67529631851005e-7, Bool[0, 0, 1])
(t, Î·, x) = (319, 7.368284462572205e-7, Bool[0, 0, 1])
(t, Î·, x) = (320, 7.073553085490403e-7, Bool[0, 0, 1])
(t, Î·, x) = (321, 6.790610953544274e-7, Bool[0, 0, 1])
(t, Î·, x) = (322, 6.518986523929016e-7, Bool[0, 0, 1])
(t, Î·, x) = (323, 6.25822705657697e-7, Bool[0, 0, 1])
(t, Î·, x) = (324, 6.007897983550947e-7, Bool[0, 0, 1])
(t, Î·, x) = (325, 5.767582065274723e-7, Bool[0, 0, 1])
(t, Î·, x) = (326, 5.536878777689935e-7, Bool[0, 0, 1])
(t, Î·, x) = (327, 5.315403628358695e-7, Bool[0, 0, 1])
(t, Î·, x) = (328, 5.102787490329774e-7, Bool[0, 0, 1])
(t, Î·, x) = (329, 4.898675989295498e-7, Bool[0, 0, 1])
(t, Î·, x) = (330, 4.70272895292112e-7, Bool[0, 0, 1])
(t, Î·, x) = (331, 4.5146197891199336e-7, Bool[0, 0, 1])
(t, Î·, x) = (332, 4.334034988673352e-7, Bool[0, 0, 1])
(t, Î·, x) = (333, 4.1606736012056444e-7, Bool[0, 0, 1])
(t, Î·, x) = (334, 3.9942466578679614e-7, Bool[0, 0, 1])
(t, Î·, x) = (335, 3.834476789421615e-7, Bool[0, 0, 1])
(t, Î·, x) = (336, 3.6810977199763784e-7, Bool[0, 0, 1])
(t, Î·, x) = (337, 3.533853814019494e-7, Bool[0, 0, 1])
(t, Î·, x) = (338, 3.3924996500900306e-7, Bool[0, 0, 1])
(t, Î·, x) = (339, 3.256799665507515e-7, Bool[0, 0, 1])
(t, Î·, x) = (340, 3.1265276856373703e-7, Bool[0, 0, 1])
(t, Î·, x) = (341, 3.0014665775013327e-7, Bool[0, 0, 1])
(t, Î·, x) = (342, 2.8814079211514354e-7, Bool[0, 0, 1])
(t, Î·, x) = (343, 2.7661515922261515e-7, Bool[0, 0, 1])
(t, Î·, x) = (344, 2.655505531024005e-7, Bool[0, 0, 1])
(t, Î·, x) = (345, 2.5492853161779294e-7, Bool[0, 0, 1])
(t, Î·, x) = (346, 2.447313907083526e-7, Bool[0, 0, 1])
(t, Î·, x) = (347, 2.3494213419184007e-7, Bool[0, 0, 1])
(t, Î·, x) = (348, 2.2554444889522074e-7, Bool[0, 0, 1])
(t, Î·, x) = (349, 2.1652267090388477e-7, Bool[0, 0, 1])
(t, Î·, x) = (350, 2.0786176424536507e-7, Bool[0, 0, 1])
(t, Î·, x) = (351, 1.9954729424398465e-7, Bool[0, 0, 1])
(t, Î·, x) = (352, 1.9156540265186095e-7, Bool[0, 0, 1])
(t, Î·, x) = (353, 1.839027863326237e-7, Bool[0, 0, 1])
(t, Î·, x) = (354, 1.7654667505695443e-7, Bool[0, 0, 1])
(t, Î·, x) = (355, 1.6948480663359078e-7, Bool[0, 0, 1])
(t, Î·, x) = (356, 1.6270541447482856e-7, Bool[0, 0, 1])
(t, Î·, x) = (357, 1.5619719917481234e-7, Bool[0, 0, 1])
(t, Î·, x) = (358, 1.499493116341455e-7, Bool[0, 0, 1])
(t, Î·, x) = (359, 1.4395133796085702e-7, Bool[0, 0, 1])
(t, Î·, x) = (360, 1.3819328437136846e-7, Bool[0, 0, 1])
(t, Î·, x) = (361, 1.3266555320967655e-7, Bool[0, 0, 1])
(t, Î·, x) = (362, 1.2735893140103371e-7, Bool[0, 0, 1])
(t, Î·, x) = (363, 1.2226457357655818e-7, Bool[0, 0, 1])
(t, Î·, x) = (364, 1.1737399141509286e-7, Bool[0, 0, 1])
(t, Î·, x) = (365, 1.1267903232692333e-7, Bool[0, 0, 1])
(t, Î·, x) = (366, 1.0817187057199362e-7, Bool[0, 0, 1])
(t, Î·, x) = (367, 1.0384499482540832e-7, Bool[0, 0, 1])
(t, Î·, x) = (368, 9.969119574293472e-8, Bool[0, 0, 1])
(t, Î·, x) = (369, 9.570354819743443e-8, Bool[0, 0, 1])
(t, Î·, x) = (370, 9.187540683797124e-8, Bool[0, 0, 1])
(t, Î·, x) = (371, 8.820039010259961e-8, Bool[0, 0, 1])
(t, Î·, x) = (372, 8.467237400111571e-8, Bool[0, 0, 1])
(t, Î·, x) = (373, 8.128547968055955e-8, Bool[0, 0, 1])
(t, Î·, x) = (374, 7.803406099071708e-8, Bool[0, 0, 1])
(t, Î·, x) = (375, 7.49126982668713e-8, Bool[0, 0, 1])
(t, Î·, x) = (376, 7.191619033619645e-8, Bool[0, 0, 1])
(t, Î·, x) = (377, 6.903954297143855e-8, Bool[0, 0, 1])
(t, Î·, x) = (378, 6.627796089730964e-8, Bool[0, 0, 1])
(t, Î·, x) = (379, 6.362684246141725e-8, Bool[0, 0, 1])
(t, Î·, x) = (380, 6.108176897612339e-8, Bool[0, 0, 1])
(t, Î·, x) = (381, 5.8638498501295544e-8, Bool[0, 0, 1])
(t, Î·, x) = (382, 5.6292957850700986e-8, Bool[0, 0, 1])
(t, Î·, x) = (383, 5.404123992747145e-8, Bool[0, 0, 1])
(t, Î·, x) = (384, 5.187959040142687e-8, Bool[0, 0, 1])
(t, Î·, x) = (385, 4.980440682089693e-8, Bool[0, 0, 1])
(t, Î·, x) = (386, 4.7812230619115326e-8, Bool[0, 0, 1])
(t, Î·, x) = (387, 4.589974178514922e-8, Bool[0, 0, 1])
(t, Î·, x) = (388, 4.406375175847188e-8, Bool[0, 0, 1])
(t, Î·, x) = (389, 4.230120165260587e-8, Bool[0, 0, 1])
(t, Î·, x) = (390, 4.060915337333881e-8, Bool[0, 0, 1])
(t, Î·, x) = (391, 3.8984787842366586e-8, Bool[0, 0, 1])
(t, Î·, x) = (392, 3.74253961155091e-8, Bool[0, 0, 1])
(t, Î·, x) = (393, 3.592838027088874e-8, Bool[0, 0, 1])
(t, Î·, x) = (394, 3.4491245415324556e-8, Bool[0, 0, 1])
(t, Î·, x) = (395, 3.3111595243440206e-8, Bool[0, 0, 1])
(t, Î·, x) = (396, 3.178713203766392e-8, Bool[0, 0, 1])
(t, Î·, x) = (397, 3.0515646010087494e-8, Bool[0, 0, 1])
(t, Î·, x) = (398, 2.9295019743358353e-8, Bool[0, 0, 1])
(t, Î·, x) = (399, 2.8123219308895386e-8, Bool[0, 0, 1])
(t, Î·, x) = (400, 2.6998289825996835e-8, Bool[0, 0, 1])
(t, Î·, x) = (401, 2.591835901455397e-8, Bool[0, 0, 1])
(t, Î·, x) = (402, 2.4881624760553223e-8, Bool[0, 0, 1])
(t, Î·, x) = (403, 2.3886359556968273e-8, Bool[0, 0, 1])
(t, Î·, x) = (404, 2.2930905174689542e-8, Bool[0, 0, 1])
(t, Î·, x) = (405, 2.2013668221632088e-8, Bool[0, 0, 1])
(t, Î·, x) = (406, 2.1133121919092446e-8, Bool[0, 0, 1])
(t, Î·, x) = (407, 2.028779810814285e-8, Bool[0, 0, 1])
(t, Î·, x) = (408, 1.947628636145282e-8, Bool[0, 0, 1])
(t, Î·, x) = (409, 1.8697233983289152e-8, Bool[0, 0, 1])
(t, Î·, x) = (410, 1.79493451213375e-8, Bool[0, 0, 1])
(t, Î·, x) = (411, 1.723137188491819e-8, Bool[0, 0, 1])
(t, Î·, x) = (412, 1.6542117009521462e-8, Bool[0, 0, 1])
(t, Î·, x) = (413, 1.5880432080450646e-8, Bool[0, 0, 1])
(t, Î·, x) = (414, 1.5245214868286894e-8, Bool[0, 0, 1])
(t, Î·, x) = (415, 1.4635406664353923e-8, Bool[0, 0, 1])
(t, Î·, x) = (416, 1.4049989616182756e-8, Bool[0, 0, 1])
(t, Î·, x) = (417, 1.3487990280225404e-8, Bool[0, 0, 1])
(t, Î·, x) = (418, 1.2948470740070661e-8, Bool[0, 0, 1])
(t, Î·, x) = (419, 1.2430532159157792e-8, Bool[0, 0, 1])
(t, Î·, x) = (420, 1.1933310339884429e-8, Bool[0, 0, 1])
(t, Î·, x) = (421, 1.145597838814183e-8, Bool[0, 0, 1])
(t, Î·, x) = (422, 1.0997738719709105e-8, Bool[0, 0, 1])
(t, Î·, x) = (423, 1.0557828389323731e-8, Bool[0, 0, 1])
(t, Î·, x) = (424, 1.0135515537967876e-8, Bool[0, 0, 1])</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>(V_U = [6.049790992670206, 6.049790992670206, 7.503338493801174], V_E = [-9.034199339279674, 1.2647043614819962, 8.048418806725287])</code></pre>
</div>
</div>
<p><strong>Implement Policy Iteration and compare rates of convergence.</strong></p>
<div id="a3325312" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>[<span class="cn">true</span>, <span class="cn">false</span>, <span class="cn">true</span>] <span class="op">==</span> [<span class="cn">true</span>, <span class="cn">true</span>, <span class="cn">true</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>false</code></pre>
</div>
</div>
<div id="0d8937c9" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">policy_iteration</span>(p; T<span class="op">=</span><span class="fl">1000</span>,  verbose<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> V_U, V_E, x</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    x_0 <span class="op">=</span> <span class="fu">zeros</span>(<span class="dt">Bool</span>, <span class="fl">3</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    V_U_0, V_E_0 <span class="op">=</span> <span class="fu">policy_eval</span>(x_0, p; verbose<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t<span class="op">=</span><span class="fl">1</span><span class="op">:</span>T</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        V_U_t, V_E_t, x <span class="op">=</span> <span class="fu">bellman_step</span>(V_U_0, V_E_0, p)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        V_U, V_E <span class="op">=</span> <span class="fu">policy_eval</span>(x, p; verbose<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        V_U_0, V_E_0 <span class="op">=</span> V_U, V_E</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>            <span class="pp">@show</span> (t, x, V_U, V_E)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (x<span class="op">==</span>x_0)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>        x_0 <span class="op">=</span> x</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (; V_U, V_E, x)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>policy_iteration (generic function with 1 method)</code></pre>
</div>
</div>
<div id="8f74df8f" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">policy_iteration</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(t, x, V_U, V_E) = (1, Bool[0, 1, 1], [3.1389163916366356, 0.42757754738899856, 6.939943411173783], [-9.621069208340083, 0.6778344871456846, 7.461548928913835])
(t, x, V_U, V_E) = (2, Bool[0, 0, 1], [6.049790992524931, 6.049790992524931, 7.503338493655899], [-9.034199339424942, 1.264704361336724, 8.048418806580012])
(t, x, V_U, V_E) = (3, Bool[0, 0, 1], [6.049790992524931, 6.049790992524931, 7.503338493655899], [-9.034199339424942, 1.264704361336724, 8.048418806580012])</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>(V_U = [6.049790992524931, 6.049790992524931, 7.503338493655899], V_E = [-9.034199339424942, 1.264704361336724, 8.048418806580012], x = Bool[0, 0, 1])</code></pre>
</div>
</div>
<p><strong>Discuss the Effects of the Parameters</strong></p>
<div id="2bfc71ed" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(Î² = 0.96, Î» = 0.01, cbar = 0.8, wvec = [0.6, 1.0, 1.4], pvec = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333])</code></pre>
</div>
</div>
<div id="1247ce13" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">policy_iteration</span>(m; verbose<span class="op">=</span><span class="cn">false</span>).x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>3-element Vector{Bool}:
 0
 0
 1</code></pre>
</div>
</div>
<div id="43413a30" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(m, (;cbar<span class="op">=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(Î² = 0.96, Î» = 0.01, cbar = 0.5, wvec = [0.6, 1.0, 1.4], pvec = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333])</code></pre>
</div>
</div>
<div id="fe8c8de9" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">policy_iteration</span>(<span class="fu">merge</span>(m, (;cbar<span class="op">=</span><span class="fl">0.5</span>, Î²<span class="op">=</span><span class="fl">0.1</span>)); verbose<span class="op">=</span><span class="cn">false</span>).x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>3-element Vector{Bool}:
 1
 1
 1</code></pre>
</div>
</div>
<div id="8710f752" class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">policy_iteration</span>(<span class="fu">merge</span>(m, (;cbar<span class="op">=</span><span class="fl">0.5</span>, Î»<span class="op">=</span><span class="fl">0.2</span>)); verbose<span class="op">=</span><span class="cn">false</span>).x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>3-element Vector{Bool}:
 0
 1
 1</code></pre>
</div>
</div>
<div id="773092e4" class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">policy_iteration</span>(<span class="fu">merge</span>(m, (;cbar<span class="op">=</span><span class="fl">0.6</span>, wvec<span class="op">=</span>[<span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">1.1</span>], Î»<span class="op">=</span><span class="fl">0.1</span>)); verbose<span class="op">=</span><span class="cn">false</span>).xa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>3-element Vector{Bool}:
 0
 1
 1</code></pre>
</div>
</div>
<div id="91607f25" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">value_iteration</span>(<span class="fu">merge</span>(m, (;cbar<span class="op">=</span><span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(t, Î·, x) = (1, 0.6931471805599453, Bool[0, 0, 0])
(t, Î·, x) = (2, 0.4921428857605732, Bool[1, 1, 1])
(t, Î·, x) = (3, 0.4682682122321573, Bool[0, 1, 1])
(t, Î·, x) = (4, 0.4448321065334351, Bool[0, 1, 1])
(t, Î·, x) = (5, 0.421809731483338, Bool[0, 1, 1])
(t, Î·, x) = (6, 0.3997326104086891, Bool[0, 1, 1])
(t, Î·, x) = (7, 0.37872378365529347, Bool[0, 1, 1])
(t, Î·, x) = (8, 0.3587816360837337, Bool[0, 1, 1])
(t, Î·, x) = (9, 0.3398678888101081, Bool[0, 1, 1])
(t, Î·, x) = (10, 0.3219348089922658, Bool[0, 1, 1])
(t, Î·, x) = (11, 0.3049335580865655, Bool[0, 0, 1])
(t, Î·, x) = (12, 0.288499138959482, Bool[0, 0, 1])
(t, Î·, x) = (13, 0.27272309403811246, Bool[0, 0, 1])
(t, Î·, x) = (14, 0.2576563449970104, Bool[0, 0, 1])
(t, Î·, x) = (15, 0.24331537237385614, Bool[0, 0, 1])
(t, Î·, x) = (16, 0.22969576080372534, Bool[0, 0, 1])
(t, Î·, x) = (17, 0.2167806958310372, Bool[0, 0, 1])
(t, Î·, x) = (18, 0.20454628035002465, Bool[0, 0, 1])
(t, Î·, x) = (19, 0.192964848183526, Bool[0, 0, 1])
(t, Î·, x) = (20, 0.1820070169983703, Bool[0, 0, 1])
(t, Î·, x) = (21, 0.17164294834044735, Bool[0, 0, 1])
(t, Î·, x) = (22, 0.16184310958625314, Bool[0, 0, 1])
(t, Î·, x) = (23, 0.15257872356187008, Bool[0, 0, 1])
(t, Î·, x) = (24, 0.14382202284234058, Bool[0, 0, 1])
(t, Î·, x) = (25, 0.1355463824162415, Bool[0, 0, 1])
(t, Î·, x) = (26, 0.12772637709023904, Bool[0, 0, 1])
(t, Î·, x) = (27, 0.12033779279605739, Bool[0, 0, 1])
(t, Î·, x) = (28, 0.11335761011523093, Bool[0, 0, 1])
(t, Î·, x) = (29, 0.10676397150256633, Bool[0, 0, 1])
(t, Î·, x) = (30, 0.10053613938402695, Bool[0, 0, 1])
(t, Î·, x) = (31, 0.0946544495939623, Bool[0, 0, 1])
(t, Î·, x) = (32, 0.08910026291063655, Bool[0, 0, 1])
(t, Î·, x) = (33, 0.08385591637642165, Bool[0, 0, 1])
(t, Î·, x) = (34, 0.07920130290952265, Bool[0, 0, 1])
(t, Î·, x) = (35, 0.07603322629350462, Bool[0, 0, 1])
(t, Î·, x) = (36, 0.0729918817971944, Bool[0, 0, 1])
(t, Î·, x) = (37, 0.07007219678904875, Bool[0, 0, 1])
(t, Î·, x) = (38, 0.06726930277975018, Bool[0, 0, 1])
(t, Î·, x) = (39, 0.06457852679933129, Bool[0, 0, 1])
(t, Î·, x) = (40, 0.06199538328819543, Bool[0, 0, 1])
(t, Î·, x) = (41, 0.05951556641901945, Bool[0, 0, 1])
(t, Î·, x) = (42, 0.05713494279292508, Bool[0, 0, 1])
(t, Î·, x) = (43, 0.05484954447014179, Bool[0, 0, 1])
(t, Î·, x) = (44, 0.052655562306118675, Bool[0, 0, 1])
(t, Î·, x) = (45, 0.0505493395710328, Bool[0, 0, 1])
(t, Î·, x) = (46, 0.04852736583510531, Bool[0, 0, 1])
(t, Î·, x) = (47, 0.046586271105194754, Bool[0, 0, 1])
(t, Î·, x) = (48, 0.04472282020014973, Bool[0, 0, 1])
(t, Î·, x) = (49, 0.04293390735379177, Bool[0, 0, 1])
(t, Î·, x) = (50, 0.04121655103546207, Bool[0, 0, 1])
(t, Î·, x) = (51, 0.03956788897880337, Bool[0, 0, 1])
(t, Î·, x) = (52, 0.037985173410042705, Bool[0, 0, 1])
(t, Î·, x) = (53, 0.03646576646758426, Bool[0, 0, 1])
(t, Î·, x) = (54, 0.03500713580506343, Bool[0, 0, 1])
(t, Î·, x) = (55, 0.033606850370453856, Bool[0, 0, 1])
(t, Î·, x) = (56, 0.032262576354117556, Bool[0, 0, 1])
(t, Î·, x) = (57, 0.030972073298996428, Bool[0, 0, 1])
(t, Î·, x) = (58, 0.02973319036643307, Bool[0, 0, 1])
(t, Î·, x) = (59, 0.028543862751395643, Bool[0, 0, 1])
(t, Î·, x) = (60, 0.027402108241100898, Bool[0, 0, 1])
(t, Î·, x) = (61, 0.026306023911305765, Bool[0, 0, 1])
(t, Î·, x) = (62, 0.02525378295475811, Bool[0, 0, 1])
(t, Î·, x) = (63, 0.02424363163650689, Bool[0, 0, 1])
(t, Î·, x) = (64, 0.023273886371010022, Bool[0, 0, 1])
(t, Î·, x) = (65, 0.022342930916145143, Bool[0, 0, 1])
(t, Î·, x) = (66, 0.021449213679483492, Bool[0, 0, 1])
(t, Î·, x) = (67, 0.020591245132295377, Bool[0, 0, 1])
(t, Î·, x) = (68, 0.019767595326998233, Bool[0, 0, 1])
(t, Î·, x) = (69, 0.018976891513912797, Bool[0, 0, 1])
(t, Î·, x) = (70, 0.018217815853355468, Bool[0, 0, 1])
(t, Î·, x) = (71, 0.017489103219220148, Bool[0, 0, 1])
(t, Î·, x) = (72, 0.01678953909044978, Bool[0, 0, 1])
(t, Î·, x) = (73, 0.016117957526832427, Bool[0, 0, 1])
(t, Î·, x) = (74, 0.015473239225757496, Bool[0, 0, 1])
(t, Î·, x) = (75, 0.014854309656726628, Bool[0, 0, 1])
(t, Î·, x) = (76, 0.014260137270457385, Bool[0, 0, 1])
(t, Î·, x) = (77, 0.013689731779639835, Bool[0, 0, 1])
(t, Î·, x) = (78, 0.013142142508454135, Bool[0, 0, 1])
(t, Î·, x) = (79, 0.012616456808116183, Bool[0, 0, 1])
(t, Î·, x) = (80, 0.012111798535791252, Bool[0, 0, 1])
(t, Î·, x) = (81, 0.011627326594359388, Bool[0, 0, 1])
(t, Î·, x) = (82, 0.011162233530584764, Bool[0, 0, 1])
(t, Î·, x) = (83, 0.010715744189361942, Bool[0, 0, 1])
(t, Î·, x) = (84, 0.010287114421787535, Bool[0, 0, 1])
(t, Î·, x) = (85, 0.009875629844915856, Bool[0, 0, 1])
(t, Î·, x) = (86, 0.009480604651119329, Bool[0, 0, 1])
(t, Î·, x) = (87, 0.009101380465074804, Bool[0, 0, 1])
(t, Î·, x) = (88, 0.008737325246471528, Bool[0, 0, 1])
(t, Î·, x) = (89, 0.00838783223661288, Bool[0, 0, 1])
(t, Î·, x) = (90, 0.008052318947147974, Bool[0, 0, 1])
(t, Î·, x) = (91, 0.007730226189262446, Bool[0, 0, 1])
(t, Î·, x) = (92, 0.007421017141691522, Bool[0, 0, 1])
(t, Î·, x) = (93, 0.007124176456024145, Bool[0, 0, 1])
(t, Î·, x) = (94, 0.0068392093977829305, Bool[0, 0, 1])
(t, Î·, x) = (95, 0.006565641021872182, Bool[0, 0, 1])
(t, Î·, x) = (96, 0.006303015380996868, Bool[0, 0, 1])
(t, Î·, x) = (97, 0.006050894765757597, Bool[0, 0, 1])
(t, Î·, x) = (98, 0.005808858975126618, Bool[0, 0, 1])
(t, Î·, x) = (99, 0.005576504616121802, Bool[0, 0, 1])
(t, Î·, x) = (100, 0.005353444431476895, Bool[0, 0, 1])
(t, Î·, x) = (101, 0.005139306654218245, Bool[0, 0, 1])
(t, Î·, x) = (102, 0.004933734388049338, Bool[0, 0, 1])
(t, Î·, x) = (103, 0.004736385012527045, Bool[0, 0, 1])
(t, Î·, x) = (104, 0.004546929612025963, Bool[0, 0, 1])
(t, Î·, x) = (105, 0.004365052427544924, Bool[0, 0, 1])
(t, Î·, x) = (106, 0.004190450330443518, Bool[0, 0, 1])
(t, Î·, x) = (107, 0.004022832317224889, Bool[0, 0, 1])
(t, Î·, x) = (108, 0.0038619190245370305, Bool[0, 0, 1])
(t, Î·, x) = (109, 0.0037074422635550164, Bool[0, 0, 1])
(t, Î·, x) = (110, 0.0035591445730132065, Bool[0, 0, 1])
(t, Î·, x) = (111, 0.0034167787900925006, Bool[0, 0, 1])
(t, Î·, x) = (112, 0.0032801076384885164, Bool[0, 0, 1])
(t, Î·, x) = (113, 0.00314890333294926, Bool[0, 0, 1])
(t, Î·, x) = (114, 0.003022947199631254, Bool[0, 0, 1])
(t, Î·, x) = (115, 0.0029020293116461815, Bool[0, 0, 1])
(t, Î·, x) = (116, 0.0027859481391807606, Bool[0, 0, 1])
(t, Î·, x) = (117, 0.0026745102136125354, Bool[0, 0, 1])
(t, Î·, x) = (118, 0.002567529805068247, Bool[0, 0, 1])
(t, Î·, x) = (119, 0.002464828612866121, Bool[0, 0, 1])
(t, Î·, x) = (120, 0.002366235468350908, Bool[0, 0, 1])
(t, Î·, x) = (121, 0.0022715860496171913, Bool[0, 0, 1])
(t, Î·, x) = (122, 0.002180722607632468, Bool[0, 0, 1])
(t, Î·, x) = (123, 0.0020934937033274537, Bool[0, 0, 1])
(t, Î·, x) = (124, 0.0020097539551944266, Bool[0, 0, 1])
(t, Î·, x) = (125, 0.0019293637969868271, Bool[0, 0, 1])
(t, Î·, x) = (126, 0.0018521892451071054, Bool[0, 0, 1])
(t, Î·, x) = (127, 0.001778101675302679, Bool[0, 0, 1])
(t, Î·, x) = (128, 0.0017069776082907495, Bool[0, 0, 1])
(t, Î·, x) = (129, 0.00163869850395848, Bool[0, 0, 1])
(t, Î·, x) = (130, 0.0015731505638001408, Bool[0, 0, 1])
(t, Î·, x) = (131, 0.001510224541248384, Bool[0, 0, 1])
(t, Î·, x) = (132, 0.0014498155595985551, Bool[0, 0, 1])
(t, Î·, x) = (133, 0.0013918229372151814, Bool[0, 0, 1])
(t, Î·, x) = (134, 0.001336150019725757, Bool[0, 0, 1])
(t, Î·, x) = (135, 0.001282704018937153, Bool[0, 0, 1])
(t, Î·, x) = (136, 0.0012313958581797735, Bool[0, 0, 1])
(t, Î·, x) = (137, 0.0011821400238529733, Bool[0, 0, 1])
(t, Î·, x) = (138, 0.0011348544228981794, Bool[0, 0, 1])
(t, Î·, x) = (139, 0.0010894602459821101, Bool[0, 0, 1])
(t, Î·, x) = (140, 0.001045881836143181, Bool[0, 0, 1])
(t, Î·, x) = (141, 0.0010040465626968142, Bool[0, 0, 1])
(t, Î·, x) = (142, 0.0009638847001891548, Bool[0, 0, 1])
(t, Î·, x) = (143, 0.0009253293121815886, Bool[0, 0, 1])
(t, Î·, x) = (144, 0.0008883161396946448, Bool[0, 0, 1])
(t, Î·, x) = (145, 0.0008527834941070012, Bool[0, 0, 1])
(t, Î·, x) = (146, 0.0008186721543426145, Bool[0, 0, 1])
(t, Î·, x) = (147, 0.0007859252681692297, Bool[0, 0, 1])
(t, Î·, x) = (148, 0.0007544882574421763, Bool[0, 0, 1])
(t, Î·, x) = (149, 0.0007243087271451287, Bool[0, 0, 1])
(t, Î·, x) = (150, 0.0006953363780590749, Bool[0, 0, 1])
(t, Î·, x) = (151, 0.0006675229229360369, Bool[0, 0, 1])
(t, Î·, x) = (152, 0.000640822006019448, Bool[0, 0, 1])
(t, Î·, x) = (153, 0.0006151891257779596, Bool[0, 0, 1])
(t, Î·, x) = (154, 0.0005905815607469833, Bool[0, 0, 1])
(t, Î·, x) = (155, 0.0005669582983172106, Bool[0, 0, 1])
(t, Î·, x) = (156, 0.0005442799663848419, Bool[0, 0, 1])
(t, Î·, x) = (157, 0.0005225087677294127, Bool[0, 0, 1])
(t, Î·, x) = (158, 0.0005016084170197388, Bool[0, 0, 1])
(t, Î·, x) = (159, 0.00048154408033962426, Bool[0, 0, 1])
(t, Î·, x) = (160, 0.00046228231712586165, Bool[0, 0, 1])
(t, Î·, x) = (161, 0.00044379102444036533, Bool[0, 0, 1])
(t, Î·, x) = (162, 0.0004260393834636389, Bool[0, 0, 1])
(t, Î·, x) = (163, 0.00040899780812431175, Bool[0, 0, 1])
(t, Î·, x) = (164, 0.0003926378957999077, Bool[0, 0, 1])
(t, Î·, x) = (165, 0.0003769323799680535, Bool[0, 0, 1])
(t, Î·, x) = (166, 0.00036185508476904715, Bool[0, 0, 1])
(t, Î·, x) = (167, 0.00034738088137853396, Bool[0, 0, 1])
(t, Î·, x) = (168, 0.00033348564612278864, Bool[0, 0, 1])
(t, Î·, x) = (169, 0.0003201462202779837, Bool[0, 0, 1])
(t, Î·, x) = (170, 0.00030734037146729065, Bool[0, 0, 1])
(t, Î·, x) = (171, 0.00029504675660785296, Bool[0, 0, 1])
(t, Î·, x) = (172, 0.00028324488634368095, Bool[0, 0, 1])
(t, Î·, x) = (173, 0.00027191509089075083, Bool[0, 0, 1])
(t, Î·, x) = (174, 0.0002610384872543392, Bool[0, 0, 1])
(t, Î·, x) = (175, 0.0002505969477644143, Bool[0, 0, 1])
(t, Î·, x) = (176, 0.00024057306985358906, Bool[0, 0, 1])
(t, Î·, x) = (177, 0.00023095014705987182, Bool[0, 0, 1])
(t, Î·, x) = (178, 0.00022171214117783222, Bool[0, 0, 1])
(t, Î·, x) = (179, 0.00021284365553064788, Bool[0, 0, 1])
(t, Î·, x) = (180, 0.00020432990930885353, Bool[0, 0, 1])
(t, Î·, x) = (181, 0.00019615671293671255, Bool[0, 0, 1])
(t, Î·, x) = (182, 0.00018831044441913747, Bool[0, 0, 1])
(t, Î·, x) = (183, 0.00018077802664251408, Bool[0, 0, 1])
(t, Î·, x) = (184, 0.00017354690557702668, Bool[0, 0, 1])
(t, Î·, x) = (185, 0.00016660502935383903, Bool[0, 0, 1])
(t, Î·, x) = (186, 0.00015994082817982758, Bool[0, 0, 1])
(t, Î·, x) = (187, 0.00015354319505256342, Bool[0, 0, 1])
(t, Î·, x) = (188, 0.00014740146725067405, Bool[0, 0, 1])
(t, Î·, x) = (189, 0.00014150540856050497, Bool[0, 0, 1])
(t, Î·, x) = (190, 0.00013584519221776503, Bool[0, 0, 1])
(t, Î·, x) = (191, 0.00013041138452951628, Bool[0, 0, 1])
(t, Î·, x) = (192, 0.00012519492914808694, Bool[0, 0, 1])
(t, Î·, x) = (193, 0.00012018713198269637, Bool[0, 0, 1])
(t, Î·, x) = (194, 0.0001153796467034951, Bool[0, 0, 1])
(t, Î·, x) = (195, 0.00011076446083446712, Bool[0, 0, 1])
(t, Î·, x) = (196, 0.0001063338824014437, Bool[0, 0, 1])
(t, Î·, x) = (197, 0.00010208052710503068, Bool[0, 0, 1])
(t, Î·, x) = (198, 9.799730602111367e-5, Bool[0, 0, 1])
(t, Î·, x) = (199, 9.407741378097967e-5, Bool[0, 0, 1])
(t, Î·, x) = (200, 9.031431722927863e-5, Bool[0, 0, 1])
(t, Î·, x) = (201, 8.670174454028512e-5, Bool[0, 0, 1])
(t, Î·, x) = (202, 8.323367475870924e-5, Bool[0, 0, 1])
(t, Î·, x) = (203, 7.990432776772138e-5, Bool[0, 0, 1])
(t, Î·, x) = (204, 7.670815465754544e-5, Bool[0, 0, 1])
(t, Î·, x) = (205, 7.363982847152784e-5, Bool[0, 0, 1])
(t, Î·, x) = (206, 7.069423533234698e-5, Bool[0, 0, 1])
(t, Î·, x) = (207, 6.78664659190531e-5, Bool[0, 0, 1])
(t, Î·, x) = (208, 6.515180728250414e-5, Bool[0, 0, 1])
(t, Î·, x) = (209, 6.254573499120397e-5, Bool[0, 0, 1])
(t, Î·, x) = (210, 6.004390559155581e-5, Bool[0, 0, 1])
(t, Î·, x) = (211, 5.764214936743173e-5, Bool[0, 0, 1])
(t, Î·, x) = (212, 5.533646339284104e-5, Bool[0, 0, 1])
(t, Î·, x) = (213, 5.312300485726951e-5, Bool[0, 0, 1])
(t, Î·, x) = (214, 5.099808466368927e-5, Bool[0, 0, 1])
(t, Î·, x) = (215, 4.895816127614694e-5, Bool[0, 0, 1])
(t, Î·, x) = (216, 4.6999834825811604e-5, Bool[0, 0, 1])
(t, Î·, x) = (217, 4.5119841431962016e-5, Bool[0, 0, 1])
(t, Î·, x) = (218, 4.331504777521644e-5, Bool[0, 0, 1])
(t, Î·, x) = (219, 4.158244586438542e-5, Bool[0, 0, 1])
(t, Î·, x) = (220, 3.991914802981e-5, Bool[0, 0, 1])
(t, Î·, x) = (221, 3.832238210854655e-5, Bool[0, 0, 1])
(t, Î·, x) = (222, 3.678948682406258e-5, Bool[0, 0, 1])
(t, Î·, x) = (223, 3.531790735156193e-5, Bool[0, 0, 1])
(t, Î·, x) = (224, 3.390519105739287e-5, Bool[0, 0, 1])
(t, Î·, x) = (225, 3.254898341431556e-5, Bool[0, 0, 1])
(t, Î·, x) = (226, 3.124702407841795e-5, Bool[0, 0, 1])
(t, Î·, x) = (227, 2.9997143115245706e-5, Bool[0, 0, 1])
(t, Î·, x) = (228, 2.879725739024508e-5, Bool[0, 0, 1])
(t, Î·, x) = (229, 2.764536709509713e-5, Bool[0, 0, 1])
(t, Î·, x) = (230, 2.653955241083139e-5, Bool[0, 0, 1])
(t, Î·, x) = (231, 2.547797031482446e-5, Bool[0, 0, 1])
(t, Î·, x) = (232, 2.445885150237359e-5, Bool[0, 0, 1])
(t, Î·, x) = (233, 2.348049744149705e-5, Bool[0, 0, 1])
(t, Î·, x) = (234, 2.2541277544974037e-5, Bool[0, 0, 1])
(t, Î·, x) = (235, 2.163962644274875e-5, Bool[0, 0, 1])
(t, Î·, x) = (236, 2.077404138489669e-5, Bool[0, 0, 1])
(t, Î·, x) = (237, 1.9943079729856095e-5, Bool[0, 0, 1])
(t, Î·, x) = (238, 1.9145356541017122e-5, Bool[0, 0, 1])
(t, Î·, x) = (239, 1.837954227923433e-5, Bool[0, 0, 1])
(t, Î·, x) = (240, 1.7644360586821506e-5, Bool[0, 0, 1])
(t, Î·, x) = (241, 1.693858616391708e-5, Bool[0, 0, 1])
(t, Î·, x) = (242, 1.626104271768014e-5, Bool[0, 0, 1])
(t, Î·, x) = (243, 1.5610601009186098e-5, Bool[0, 0, 1])
(t, Î·, x) = (244, 1.4986176968712073e-5, Bool[0, 0, 1])
(t, Î·, x) = (245, 1.4386729890070171e-5, Bool[0, 0, 1])
(t, Î·, x) = (246, 1.3811260694218674e-5, Bool[0, 0, 1])
(t, Î·, x) = (247, 1.3258810266592036e-5, Bool[0, 0, 1])
(t, Î·, x) = (248, 1.272845785660337e-5, Bool[0, 0, 1])
(t, Î·, x) = (249, 1.2219319541983964e-5, Bool[0, 0, 1])
(t, Î·, x) = (250, 1.173054676062435e-5, Bool[0, 0, 1])
(t, Î·, x) = (251, 1.1261324889488833e-5, Bool[0, 0, 1])
(t, Î·, x) = (252, 1.0810871893696117e-5, Bool[0, 0, 1])
(t, Î·, x) = (253, 1.037843701823249e-5, Bool[0, 0, 1])
(t, Î·, x) = (254, 9.963299537396608e-6, Bool[0, 0, 1])
(t, Î·, x) = (255, 9.564767555758635e-6, Bool[0, 0, 1])
(t, Î·, x) = (256, 9.182176854416468e-6, Bool[0, 0, 1])
(t, Î·, x) = (257, 8.814889779884538e-6, Bool[0, 0, 1])
(t, Î·, x) = (258, 8.462294188937847e-6, Bool[0, 0, 1])
(t, Î·, x) = (259, 8.123802420989534e-6, Bool[0, 0, 1])
(t, Î·, x) = (260, 7.798850323759154e-6, Bool[0, 0, 1])
(t, Î·, x) = (261, 7.48689631091537e-6, Bool[0, 0, 1])
(t, Î·, x) = (262, 7.187420458798499e-6, Bool[0, 0, 1])
(t, Î·, x) = (263, 6.899923640446559e-6, Bool[0, 0, 1])
(t, Î·, x) = (264, 6.623926695148441e-6, Bool[0, 0, 1])
(t, Î·, x) = (265, 6.358969627306976e-6, Bool[0, 0, 1])
(t, Î·, x) = (266, 6.104610841717317e-6, Bool[0, 0, 1])
(t, Î·, x) = (267, 5.860426408155206e-6, Bool[0, 0, 1])
(t, Î·, x) = (268, 5.626009351722416e-6, Bool[0, 0, 1])
(t, Î·, x) = (269, 5.400968977831155e-6, Bool[0, 0, 1])
(t, Î·, x) = (270, 5.184930219392925e-6, Bool[0, 0, 1])
(t, Î·, x) = (271, 4.9775330097645565e-6, Bool[0, 0, 1])
(t, Î·, x) = (272, 4.7784316894450285e-6, Bool[0, 0, 1])
(t, Î·, x) = (273, 4.587294422542243e-6, Bool[0, 0, 1])
(t, Î·, x) = (274, 4.403802645214228e-6, Bool[0, 0, 1])
(t, Î·, x) = (275, 4.227650539867511e-6, Bool[0, 0, 1])
(t, Î·, x) = (276, 4.058544517349105e-6, Bool[0, 0, 1])
(t, Î·, x) = (277, 3.896202737330157e-6, Bool[0, 0, 1])
(t, Î·, x) = (278, 3.7403546278014232e-6, Bool[0, 0, 1])
(t, Î·, x) = (279, 3.5907404427604206e-6, Bool[0, 0, 1])
(t, Î·, x) = (280, 3.447110824339461e-6, Bool[0, 0, 1])
(t, Î·, x) = (281, 3.309226392467224e-6, Bool[0, 0, 1])
(t, Î·, x) = (282, 3.176857336306682e-6, Bool[0, 0, 1])
(t, Î·, x) = (283, 3.0497830429965234e-6, Bool[0, 0, 1])
(t, Î·, x) = (284, 2.9277917210634996e-6, Bool[0, 0, 1])
(t, Î·, x) = (285, 2.8106800522564868e-6, Bool[0, 0, 1])
(t, Î·, x) = (286, 2.6982528504859715e-6, Bool[0, 0, 1])
(t, Î·, x) = (287, 2.5903227367507498e-6, Bool[0, 0, 1])
(t, Î·, x) = (288, 2.486709827387301e-6, Bool[0, 0, 1])
(t, Î·, x) = (289, 2.3872414338654835e-6, Bool[0, 0, 1])
(t, Î·, x) = (290, 2.2917517767950812e-6, Bool[0, 0, 1])
(t, Î·, x) = (291, 2.2000817052614252e-6, Bool[0, 0, 1])
(t, Î·, x) = (292, 2.112078437477294e-6, Bool[0, 0, 1])
(t, Î·, x) = (293, 2.027595299658458e-6, Bool[0, 0, 1])
(t, Î·, x) = (294, 1.9464914879918638e-6, Bool[0, 0, 1])
(t, Î·, x) = (295, 1.8686318279392822e-6, Bool[0, 0, 1])
(t, Î·, x) = (296, 1.793886554857238e-6, Bool[0, 0, 1])
(t, Î·, x) = (297, 1.7221310928405842e-6, Bool[0, 0, 1])
(t, Î·, x) = (298, 1.6532458495532865e-6, Bool[0, 0, 1])
(t, Î·, x) = (299, 1.5871160155001007e-6, Bool[0, 0, 1])
(t, Î·, x) = (300, 1.5236313748445696e-6, Bool[0, 0, 1])
(t, Î·, x) = (301, 1.462686118891554e-6, Bool[0, 0, 1])
(t, Î·, x) = (302, 1.404178674668799e-6, Bool[0, 0, 1])
(t, Î·, x) = (303, 1.348011528179427e-6, Bool[0, 0, 1])
(t, Î·, x) = (304, 1.29409106630618e-6, Bool[0, 0, 1])
(t, Î·, x) = (305, 1.2423274240447313e-6, Bool[0, 0, 1])
(t, Î·, x) = (306, 1.1926343272961049e-6, Bool[0, 0, 1])
(t, Î·, x) = (307, 1.144928954310842e-6, Bool[0, 0, 1])
(t, Î·, x) = (308, 1.0991317962449898e-6, Bool[0, 0, 1])
(t, Î·, x) = (309, 1.0551665239333374e-6, Bool[0, 0, 1])
(t, Î·, x) = (310, 1.0129598635444381e-6, Bool[0, 0, 1])
(t, Î·, x) = (311, 9.724414686829164e-7, Bool[0, 0, 1])
(t, Î·, x) = (312, 9.335438102553439e-7, Bool[0, 0, 1])
(t, Î·, x) = (313, 8.962020574543317e-7, Bool[0, 0, 1])
(t, Î·, x) = (314, 8.603539756180112e-7, Bool[0, 0, 1])
(t, Î·, x) = (315, 8.259398169840892e-7, Bool[0, 0, 1])
(t, Î·, x) = (316, 7.929022238784e-7, Bool[0, 0, 1])
(t, Î·, x) = (317, 7.611861354561711e-7, Bool[0, 0, 1])
(t, Î·, x) = (318, 7.307386891142187e-7, Bool[0, 0, 1])
(t, Î·, x) = (319, 7.015091414430685e-7, Bool[0, 0, 1])
(t, Î·, x) = (320, 6.734487758564001e-7, Bool[0, 0, 1])
(t, Î·, x) = (321, 6.46510825319524e-7, Bool[0, 0, 1])
(t, Î·, x) = (322, 6.20650391525146e-7, Bool[0, 0, 1])
(t, Î·, x) = (323, 5.958243756154502e-7, Bool[0, 0, 1])
(t, Î·, x) = (324, 5.719914009105764e-7, Bool[0, 0, 1])
(t, Î·, x) = (325, 5.491117454070604e-7, Bool[0, 0, 1])
(t, Î·, x) = (326, 5.271472760526308e-7, Bool[0, 0, 1])
(t, Î·, x) = (327, 5.060613839091843e-7, Bool[0, 0, 1])
(t, Î·, x) = (328, 4.85818929085724e-7, Bool[0, 0, 1])
(t, Î·, x) = (329, 4.663861723486207e-7, Bool[0, 0, 1])
(t, Î·, x) = (330, 4.4773072449544316e-7, Bool[0, 0, 1])
(t, Î·, x) = (331, 4.2982149572878825e-7, Bool[0, 0, 1])
(t, Î·, x) = (332, 4.126286361483267e-7, Bool[0, 0, 1])
(t, Î·, x) = (333, 3.9612349134188207e-7, Bool[0, 0, 1])
(t, Î·, x) = (334, 3.8027855087108264e-7, Bool[0, 0, 1])
(t, Î·, x) = (335, 3.650674091915107e-7, Bool[0, 0, 1])
(t, Î·, x) = (336, 3.504647132501759e-7, Bool[0, 0, 1])
(t, Î·, x) = (337, 3.3644612429384324e-7, Bool[0, 0, 1])
(t, Î·, x) = (338, 3.229882796773609e-7, Bool[0, 0, 1])
(t, Î·, x) = (339, 3.100687484547393e-7, Bool[0, 0, 1])
(t, Î·, x) = (340, 2.9766599851654973e-7, Bool[0, 0, 1])
(t, Î·, x) = (341, 2.8575935839825206e-7, Bool[0, 0, 1])
(t, Î·, x) = (342, 2.7432898441759335e-7, Bool[0, 0, 1])
(t, Î·, x) = (343, 2.63355825147471e-7, Bool[0, 0, 1])
(t, Î·, x) = (344, 2.528215912178666e-7, Bool[0, 0, 1])
(t, Î·, x) = (345, 2.427087277823148e-7, Bool[0, 0, 1])
(t, Î·, x) = (346, 2.3300037899076642e-7, Bool[0, 0, 1])
(t, Î·, x) = (347, 2.2368036400877145e-7, Bool[0, 0, 1])
(t, Î·, x) = (348, 2.1473314948394773e-7, Bool[0, 0, 1])
(t, Î·, x) = (349, 2.061438237888069e-7, Bool[0, 0, 1])
(t, Î·, x) = (350, 1.9789807126358028e-7, Bool[0, 0, 1])
(t, Î·, x) = (351, 1.8998214734722296e-7, Bool[0, 0, 1])
(t, Î·, x) = (352, 1.82382861702024e-7, Bool[0, 0, 1])
(t, Î·, x) = (353, 1.7508754801554005e-7, Bool[0, 0, 1])
(t, Î·, x) = (354, 1.6808404534884858e-7, Bool[0, 0, 1])
(t, Î·, x) = (355, 1.6136068392569314e-7, Bool[0, 0, 1])
(t, Î·, x) = (356, 1.5490625671077396e-7, Bool[0, 0, 1])
(t, Î·, x) = (357, 1.4871000608707163e-7, Bool[0, 0, 1])
(t, Î·, x) = (358, 1.4276160609227873e-7, Bool[0, 0, 1])
(t, Î·, x) = (359, 1.370511411025177e-7, Bool[0, 0, 1])
(t, Î·, x) = (360, 1.3156909606237832e-7, Bool[0, 0, 1])
(t, Î·, x) = (361, 1.2630633250410028e-7, Bool[0, 0, 1])
(t, Î·, x) = (362, 1.2125407877761063e-7, Bool[0, 0, 1])
(t, Î·, x) = (363, 1.1640391583966903e-7, Bool[0, 0, 1])
(t, Î·, x) = (364, 1.1174775949029936e-7, Bool[0, 0, 1])
(t, Î·, x) = (365, 1.0727784882647029e-7, Bool[0, 0, 1])
(t, Î·, x) = (366, 1.029867346957758e-7, Bool[0, 0, 1])
(t, Î·, x) = (367, 9.886726548558045e-8, Bool[0, 0, 1])
(t, Î·, x) = (368, 9.491257468852154e-8, Bool[0, 0, 1])
(t, Î·, x) = (369, 9.111607202072491e-8, Bool[0, 0, 1])
(t, Î·, x) = (370, 8.747142921095019e-8, Bool[0, 0, 1])
(t, Î·, x) = (371, 8.397257200698505e-8, Bool[0, 0, 1])
(t, Î·, x) = (372, 8.061366862932573e-8, Bool[0, 0, 1])
(t, Î·, x) = (373, 7.738912266574971e-8, Bool[0, 0, 1])
(t, Î·, x) = (374, 7.429355797228254e-8, Bool[0, 0, 1])
(t, Î·, x) = (375, 7.132181512048419e-8, Bool[0, 0, 1])
(t, Î·, x) = (376, 6.846894251566482e-8, Bool[0, 0, 1])
(t, Î·, x) = (377, 6.573018485056537e-8, Bool[0, 0, 1])
(t, Î·, x) = (378, 6.310097777628698e-8, Bool[0, 0, 1])
(t, Î·, x) = (379, 6.057693902050687e-8, Bool[0, 0, 1])
(t, Î·, x) = (380, 5.815386039387249e-8, Bool[0, 0, 1])
(t, Î·, x) = (381, 5.582770601364473e-8, Bool[0, 0, 1])
(t, Î·, x) = (382, 5.359459809284317e-8, Bool[0, 0, 1])
(t, Î·, x) = (383, 5.1450814275710854e-8, Bool[0, 0, 1])
(t, Î·, x) = (384, 4.9392781420465326e-8, Bool[0, 0, 1])
(t, Î·, x) = (385, 4.741707027022812e-8, Bool[0, 0, 1])
(t, Î·, x) = (386, 4.5520387459419e-8, Bool[0, 0, 1])
(t, Î·, x) = (387, 4.369957196104224e-8, Bool[0, 0, 1])
(t, Î·, x) = (388, 4.195158886943773e-8, Bool[0, 0, 1])
(t, Î·, x) = (389, 4.027352584756727e-8, Bool[0, 0, 1])
(t, Î·, x) = (390, 3.866258513340881e-8, Bool[0, 0, 1])
(t, Î·, x) = (391, 3.7116080875421176e-8, Bool[0, 0, 1])
(t, Î·, x) = (392, 3.5631438244365654e-8, Bool[0, 0, 1])
(t, Î·, x) = (393, 3.42061801106297e-8, Bool[0, 0, 1])
(t, Î·, x) = (394, 3.283793326147588e-8, Bool[0, 0, 1])
(t, Î·, x) = (395, 3.1524415966543984e-8, Bool[0, 0, 1])
(t, Î·, x) = (396, 3.0263439754207866e-8, Bool[0, 0, 1])
(t, Î·, x) = (397, 2.90529023061481e-8, Bool[0, 0, 1])
(t, Î·, x) = (398, 2.7890785680995123e-8, Bool[0, 0, 1])
(t, Î·, x) = (399, 2.6775154537972412e-8, Bool[0, 0, 1])
(t, Î·, x) = (400, 2.5704148143290695e-8, Bool[0, 0, 1])
(t, Î·, x) = (401, 2.4675982146504793e-8, Bool[0, 0, 1])
(t, Î·, x) = (402, 2.3688943251443106e-8, Bool[0, 0, 1])
(t, Î·, x) = (403, 2.274138477531551e-8, Bool[0, 0, 1])
(t, Î·, x) = (404, 2.1831730201427035e-8, Bool[0, 0, 1])
(t, Î·, x) = (405, 2.0958460744679996e-8, Bool[0, 0, 1])
(t, Î·, x) = (406, 2.0120122457001344e-8, Bool[0, 0, 1])
(t, Î·, x) = (407, 1.931531734555847e-8, Bool[0, 0, 1])
(t, Î·, x) = (408, 1.8542705149116046e-8, Bool[0, 0, 1])
(t, Î·, x) = (409, 1.7800996232608668e-8, Bool[0, 0, 1])
(t, Î·, x) = (410, 1.7088956916211373e-8, Bool[0, 0, 1])
(t, Î·, x) = (411, 1.6405397929020182e-8, Bool[0, 0, 1])
(t, Î·, x) = (412, 1.574918240265788e-8, Bool[0, 0, 1])
(t, Î·, x) = (413, 1.5119215213132975e-8, Bool[0, 0, 1])
(t, Î·, x) = (414, 1.4514446533553382e-8, Bool[0, 0, 1])
(t, Î·, x) = (415, 1.3933869169591162e-8, Bool[0, 0, 1])
(t, Î·, x) = (416, 1.3376514118590421e-8, Bool[0, 0, 1])
(t, Î·, x) = (417, 1.2841453234102573e-8, Bool[0, 0, 1])
(t, Î·, x) = (418, 1.2327795673172659e-8, Bool[0, 0, 1])
(t, Î·, x) = (419, 1.1834683455447248e-8, Bool[0, 0, 1])
(t, Î·, x) = (420, 1.1361295904066537e-8, Bool[0, 0, 1])
(t, Î·, x) = (421, 1.0906844316593833e-8, Bool[0, 0, 1])
(t, Î·, x) = (422, 1.0470570188658712e-8, Bool[0, 0, 1])
(t, Î·, x) = (423, 1.0051747878492279e-8, Bool[0, 0, 1])</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>(V_U = [4.066009442589008, 4.066009442589008, 6.740345591111497], V_E = [-9.339396498834146, 0.9595072017084403, 7.743221646807431])</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/albop\.github\.io\/mie37\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>